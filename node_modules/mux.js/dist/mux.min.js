!function t(e,i,a){function n(s,o){if(!i[s]){if(!e[s]){var h="function"==typeof require&&require;if(!o&&h)return h(s,!0);if(r)return r(s,!0);var d=new Error("Cannot find module '"+s+"'");throw d.code="MODULE_NOT_FOUND",d}var p=i[s]={exports:{}};e[s][0].call(p.exports,function(t){var i=e[s][1][t];return n(i||t)},p,p.exports,t,e,i,a)}return i[s].exports}for(var r="function"==typeof require&&require,s=0;s<a.length;s++)n(a[s]);return n}({1:[function(t,e,i){"use strict";var a,n=t(30);a=function(){var t=new Uint8Array,e=0;a.prototype.init.call(this),this.setTimestamp=function(t){e=t},this.parseId3TagSize=function(t,e){var i=t[e+6]<<21|t[e+7]<<14|t[e+8]<<7|t[e+9];return(16&t[e+5])>>4?i+20:i+10},this.parseAdtsSize=function(t,e){var i=(224&t[e+5])>>5,a=t[e+4]<<3;return 6144&t[e+3]|a|i},this.push=function(i){var a,n,r,s,o=0,h=0;for(t.length?(s=t.length,t=new Uint8Array(i.byteLength+s),t.set(t.subarray(0,s)),t.set(i,s)):t=i;t.length-h>=3;)if(t[h]!=="I".charCodeAt(0)||t[h+1]!=="D".charCodeAt(0)||t[h+2]!=="3".charCodeAt(0))if(!0&t[h]&&240==(240&t[h+1])){if(t.length-h<7)break;if((o=this.parseAdtsSize(t,h))>t.length)break;r={type:"audio",data:t.subarray(h,h+o),pts:e,dts:e},this.trigger("data",r),h+=o}else h++;else{if(t.length-h<10)break;if((o=this.parseId3TagSize(t,h))>t.length)break;n={type:"timed-metadata",data:t.subarray(h,h+o)},this.trigger("data",n),h+=o}a=t.length-h,t=a>0?t.subarray(h):new Uint8Array}},a.prototype=new n,e.exports=a},{}],2:[function(t,e,i){"use strict";var a=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],n=function(t){return t[0]<<21|t[1]<<14|t[2]<<7|t[3]},r=function(t,e,i){var a,n="";for(a=e;a<i;a++)n+="%"+("00"+t[a].toString(16)).slice(-2);return n},s=function(t,e,i){return unescape(r(t,e,i))},o=function(t,e){var i=t[e+6]<<21|t[e+7]<<14|t[e+8]<<7|t[e+9];return(16&t[e+5])>>4?i+20:i+10},h=function(t,e){var i=(224&t[e+5])>>5,a=t[e+4]<<3;return 6144&t[e+3]|a|i},d=function(t,e){return t[e]==="I".charCodeAt(0)&&t[e+1]==="D".charCodeAt(0)&&t[e+2]==="3".charCodeAt(0)?"timed-metadata":!0&t[e]&&240==(240&t[e+1])?"audio":null},p=function(t){for(var e=0;e+5<t.length;){if(255===t[e]&&240==(246&t[e+1]))return a[(60&t[e+2])>>>2];e++}return null},u=function(t){var e,i,a;e=10,64&t[5]&&(e+=4,e+=n(t.subarray(10,14)));do{if((i=n(t.subarray(e+4,e+8)))<1)return null;if("PRIV"===String.fromCharCode(t[e],t[e+1],t[e+2],t[e+3])){a=t.subarray(e+10,e+i+10);for(var r=0;r<a.byteLength;r++)if(0===a[r]){var o=s(a,0,r);if("com.apple.streaming.transportStreamTimestamp"===o){var h=a.subarray(r+1),d=(1&h[3])<<30|h[4]<<22|h[5]<<14|h[6]<<6|h[7]>>>2;return d*=4,d+=3&h[7]}break}}e+=10,e+=i}while(e<t.byteLength);return null};e.exports={parseId3TagSize:o,parseAdtsSize:h,parseType:d,parseSampleRate:p,parseAacTimestamp:u}},{}],3:[function(t,e,i){"use strict";var a,n=t(30),r=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];a=function(){var t;a.prototype.init.call(this),this.push=function(e){var i,a,n,s,o,h,d=0,p=0;if("audio"===e.type)for(t?(s=t,t=new Uint8Array(s.byteLength+e.data.byteLength),t.set(s),t.set(e.data,s.byteLength)):t=e.data;d+5<t.length;)if(255===t[d]&&240==(246&t[d+1])){if(a=2*(1&~t[d+1]),i=(3&t[d+3])<<11|t[d+4]<<3|(224&t[d+5])>>5,o=1024*(1+(3&t[d+6])),h=9e4*o/r[(60&t[d+2])>>>2],n=d+i,t.byteLength<n)return;if(this.trigger("data",{pts:e.pts+p*h,dts:e.dts+p*h,sampleCount:o,audioobjecttype:1+(t[d+2]>>>6&3),channelcount:(1&t[d+2])<<2|(192&t[d+3])>>>6,samplerate:r[(60&t[d+2])>>>2],samplingfrequencyindex:(60&t[d+2])>>>2,samplesize:16,data:t.subarray(d+7+a,n)}),t.byteLength===n)return void(t=void 0);p++,t=t.subarray(n)}else d++},this.flush=function(){this.trigger("done")}},a.prototype=new n,e.exports=a},{}],4:[function(t,e,i){"use strict";var a,n,r,s=t(30),o=t(29);n=function(){var t,e,i=0;n.prototype.init.call(this),this.push=function(a){var n;for(e?(n=new Uint8Array(e.byteLength+a.data.byteLength),n.set(e),n.set(a.data,e.byteLength),e=n):e=a.data;i<e.byteLength-3;i++)if(1===e[i+2]){t=i+5;break}for(;t<e.byteLength;)switch(e[t]){case 0:if(0!==e[t-1]){t+=2;break}if(0!==e[t-2]){t++;break}i+3!==t-2&&this.trigger("data",e.subarray(i+3,t-2));do{t++}while(1!==e[t]&&t<e.length);i=t-2,t+=3;break;case 1:if(0!==e[t-1]||0!==e[t-2]){t+=3;break}this.trigger("data",e.subarray(i+3,t-2)),i=t-2,t+=3;break;default:t+=3}e=e.subarray(i),t-=i,i=0},this.flush=function(){e&&e.byteLength>3&&this.trigger("data",e.subarray(i+3)),e=null,i=0,this.trigger("done")}},n.prototype=new s,r={100:!0,110:!0,122:!0,244:!0,44:!0,83:!0,86:!0,118:!0,128:!0,138:!0,139:!0,134:!0},a=function(){var t,e,i,s,h,d,p,u=new n;a.prototype.init.call(this),t=this,this.push=function(t){"video"===t.type&&(e=t.trackId,i=t.pts,s=t.dts,u.push(t))},u.on("data",function(a){var n={trackId:e,pts:i,dts:s,data:a};switch(31&a[0]){case 5:n.nalUnitType="slice_layer_without_partitioning_rbsp_idr";break;case 6:n.nalUnitType="sei_rbsp",n.escapedRBSP=h(a.subarray(1));break;case 7:n.nalUnitType="seq_parameter_set_rbsp",n.escapedRBSP=h(a.subarray(1)),n.config=d(n.escapedRBSP);break;case 8:n.nalUnitType="pic_parameter_set_rbsp";break;case 9:n.nalUnitType="access_unit_delimiter_rbsp"}t.trigger("data",n)}),u.on("done",function(){t.trigger("done")}),this.flush=function(){u.flush()},p=function(t,e){var i,a,n=8,r=8;for(i=0;i<t;i++)0!==r&&(a=e.readExpGolomb(),r=(n+a+256)%256),n=0===r?n:r},h=function(t){for(var e,i,a=t.byteLength,n=[],r=1;r<a-2;)0===t[r]&&0===t[r+1]&&3===t[r+2]?(n.push(r+2),r+=2):r++;if(0===n.length)return t;e=a-n.length,i=new Uint8Array(e);var s=0;for(r=0;r<e;s++,r++)s===n[0]&&(s++,n.shift()),i[r]=t[s];return i},d=function(t){var e,i,a,n,s,h,d,u,c,l,f,m,g,y=0,b=0,v=0,T=0,S=1;if(e=new o(t),i=e.readUnsignedByte(),n=e.readUnsignedByte(),a=e.readUnsignedByte(),e.skipUnsignedExpGolomb(),r[i]&&(s=e.readUnsignedExpGolomb(),3===s&&e.skipBits(1),e.skipUnsignedExpGolomb(),e.skipUnsignedExpGolomb(),e.skipBits(1),e.readBoolean()))for(f=3!==s?8:12,g=0;g<f;g++)e.readBoolean()&&(g<6?p(16,e):p(64,e));if(e.skipUnsignedExpGolomb(),0===(h=e.readUnsignedExpGolomb()))e.readUnsignedExpGolomb();else if(1===h)for(e.skipBits(1),e.skipExpGolomb(),e.skipExpGolomb(),d=e.readUnsignedExpGolomb(),g=0;g<d;g++)e.skipExpGolomb();if(e.skipUnsignedExpGolomb(),e.skipBits(1),u=e.readUnsignedExpGolomb(),c=e.readUnsignedExpGolomb(),l=e.readBits(1),0===l&&e.skipBits(1),e.skipBits(1),e.readBoolean()&&(y=e.readUnsignedExpGolomb(),b=e.readUnsignedExpGolomb(),v=e.readUnsignedExpGolomb(),T=e.readUnsignedExpGolomb()),e.readBoolean()&&e.readBoolean()){switch(e.readUnsignedByte()){case 1:m=[1,1];break;case 2:m=[12,11];break;case 3:m=[10,11];break;case 4:m=[16,11];break;case 5:m=[40,33];break;case 6:m=[24,11];break;case 7:m=[20,11];break;case 8:m=[32,11];break;case 9:m=[80,33];break;case 10:m=[18,11];break;case 11:m=[15,11];break;case 12:m=[64,33];break;case 13:m=[160,99];break;case 14:m=[4,3];break;case 15:m=[3,2];break;case 16:m=[2,1];break;case 255:m=[e.readUnsignedByte()<<8|e.readUnsignedByte(),e.readUnsignedByte()<<8|e.readUnsignedByte()]}m&&(S=m[0]/m[1])}return{profileIdc:i,levelIdc:a,profileCompatibility:n,width:Math.ceil((16*(u+1)-2*y-2*b)*S),height:(2-l)*(c+1)*16-2*v-2*T}}},a.prototype=new s,e.exports={H264Stream:a,NalByteStream:n}},{}],5:[function(t,e,i){e.exports={adts:t(3),h264:t(4)}},{}],6:[function(t,e,i){var a=[33,16,5,32,164,27],n=[33,65,108,84,1,2,4,8,168,2,4,8,17,191,252],r=function(t){for(var e=[];t--;)e.push(0);return e},s={96e3:[a,[227,64],r(154),[56]],88200:[a,[231],r(170),[56]],64e3:[a,[248,192],r(240),[56]],48e3:[a,[255,192],r(268),[55,148,128],r(54),[112]],44100:[a,[255,192],r(268),[55,163,128],r(84),[112]],32e3:[a,[255,192],r(268),[55,234],r(226),[112]],24e3:[a,[255,192],r(268),[55,255,128],r(268),[111,112],r(126),[224]],16e3:[a,[255,192],r(268),[55,255,128],r(268),[111,255],r(269),[223,108],r(195),[1,192]],12e3:[n,r(268),[3,127,248],r(268),[6,255,240],r(268),[13,255,224],r(268),[27,253,128],r(259),[56]],11025:[n,r(268),[3,127,248],r(268),[6,255,240],r(268),[13,255,224],r(268),[27,255,192],r(268),[55,175,128],r(108),[112]],8e3:[n,r(268),[3,121,16],r(47),[7]]};e.exports=function(t){return Object.keys(t).reduce(function(e,i){return e[i]=new Uint8Array(t[i].reduce(function(t,e){return t.concat(e)},[])),e},{})}(s)},{}],7:[function(t,e,i){"use strict";var a=t(30),n=function(t){this.numberOfTracks=0,this.metadataStream=t.metadataStream,this.videoTags=[],this.audioTags=[],this.videoTrack=null,this.audioTrack=null,this.pendingCaptions=[],this.pendingMetadata=[],this.pendingTracks=0,this.processedTracks=0,n.prototype.init.call(this),this.push=function(t){return t.text?this.pendingCaptions.push(t):t.frames?this.pendingMetadata.push(t):("video"===t.track.type&&(this.videoTrack=t.track,this.videoTags=t.tags,this.pendingTracks++),void("audio"===t.track.type&&(this.audioTrack=t.track,this.audioTags=t.tags,this.pendingTracks++)))}};n.prototype=new a,n.prototype.flush=function(t){var e,i,a,n,r={tags:{},captions:[],captionStreams:{},metadata:[]};if(this.pendingTracks<this.numberOfTracks){if("VideoSegmentStream"!==t&&"AudioSegmentStream"!==t)return;if(0===this.pendingTracks&&++this.processedTracks<this.numberOfTracks)return}if(this.processedTracks+=this.pendingTracks,this.pendingTracks=0,!(this.processedTracks<this.numberOfTracks)){for(this.videoTrack?n=this.videoTrack.timelineStartInfo.pts:this.audioTrack&&(n=this.audioTrack.timelineStartInfo.pts),r.tags.videoTags=this.videoTags,r.tags.audioTags=this.audioTags,a=0;a<this.pendingCaptions.length;a++)i=this.pendingCaptions[a],i.startTime=i.startPts-n,i.startTime/=9e4,i.endTime=i.endPts-n,i.endTime/=9e4,r.captionStreams[i.stream]=!0,r.captions.push(i);for(a=0;a<this.pendingMetadata.length;a++)e=this.pendingMetadata[a],e.cueTime=e.pts-n,e.cueTime/=9e4,r.metadata.push(e);r.metadata.dispatchType=this.metadataStream.dispatchType,this.videoTrack=null,this.audioTrack=null,this.videoTags=[],this.audioTags=[],this.pendingCaptions.length=0,this.pendingMetadata.length=0,this.pendingTracks=0,this.processedTracks=0,this.trigger("data",r),this.trigger("done")}},e.exports=n},{}],8:[function(t,e,i){"use strict";var a=t(9),n=function(t,e,i){var n,r,s,o=new Uint8Array(9),h=new DataView(o.buffer);return t=t||0,e=void 0===e||e,i=void 0===i||i,h.setUint8(0,70),h.setUint8(1,76),h.setUint8(2,86),h.setUint8(3,1),h.setUint8(4,(e?4:0)|(i?1:0)),h.setUint32(5,o.byteLength),t<=0?(r=new Uint8Array(o.byteLength+4),r.set(o),r.set([0,0,0,0],o.byteLength),r):(n=new a(a.METADATA_TAG),n.pts=n.dts=0,n.writeMetaDataDouble("duration",t),s=n.finalize().length,r=new Uint8Array(o.byteLength+s),r.set(o),r.set(h.byteLength,s),r)};e.exports=n},{}],9:[function(t,e,i){"use strict";var a;a=function(t,e){var i,n=0,r=16384,s=function(t,e){var i,a=t.position+e;a<t.bytes.byteLength||(i=new Uint8Array(2*a),i.set(t.bytes.subarray(0,t.position),0),t.bytes=i,t.view=new DataView(t.bytes.buffer))},o=a.widthBytes||new Uint8Array("width".length),h=a.heightBytes||new Uint8Array("height".length),d=a.videocodecidBytes||new Uint8Array("videocodecid".length);if(!a.widthBytes){for(i=0;i<"width".length;i++)o[i]="width".charCodeAt(i);for(i=0;i<"height".length;i++)h[i]="height".charCodeAt(i);for(i=0;i<"videocodecid".length;i++)d[i]="videocodecid".charCodeAt(i);a.widthBytes=o,a.heightBytes=h,a.videocodecidBytes=d}switch(this.keyFrame=!1,t){case a.VIDEO_TAG:this.length=16,r*=6;break;case a.AUDIO_TAG:this.length=13,this.keyFrame=!0;break;case a.METADATA_TAG:this.length=29,this.keyFrame=!0;break;default:throw new Error("Unknown FLV tag type")}this.bytes=new Uint8Array(r),this.view=new DataView(this.bytes.buffer),this.bytes[0]=t,this.position=this.length,this.keyFrame=e,this.pts=0,this.dts=0,this.writeBytes=function(t,e,i){var a,n=e||0;i=i||t.byteLength,a=n+i,s(this,i),this.bytes.set(t.subarray(n,a),this.position),this.position+=i,this.length=Math.max(this.length,this.position)},this.writeByte=function(t){s(this,1),this.bytes[this.position]=t,this.position++,this.length=Math.max(this.length,this.position)},this.writeShort=function(t){s(this,2),this.view.setUint16(this.position,t),this.position+=2,this.length=Math.max(this.length,this.position)},this.negIndex=function(t){return this.bytes[this.length-t]},this.nalUnitSize=function(){return 0===n?0:this.length-(n+4)},this.startNalUnit=function(){if(n>0)throw new Error("Attempted to create new NAL wihout closing the old one");n=this.length,this.length+=4,this.position=this.length},this.endNalUnit=function(t){var e,i;this.length===n+4?this.length-=4:n>0&&(e=n+4,i=this.length-e,this.position=n,this.view.setUint32(this.position,i),this.position=this.length,t&&t.push(this.bytes.subarray(e,e+i))),n=0},this.writeMetaDataDouble=function(t,e){var i;if(s(this,2+t.length+9),this.view.setUint16(this.position,t.length),this.position+=2,"width"===t)this.bytes.set(o,this.position),this.position+=5;else if("height"===t)this.bytes.set(h,this.position),this.position+=6;else if("videocodecid"===t)this.bytes.set(d,this.position),this.position+=12;else for(i=0;i<t.length;i++)this.bytes[this.position]=t.charCodeAt(i),this.position++;this.position++,this.view.setFloat64(this.position,e),this.position+=8,this.length=Math.max(this.length,this.position),++n},this.writeMetaDataBoolean=function(t,e){var i;for(s(this,2),this.view.setUint16(this.position,t.length),this.position+=2,i=0;i<t.length;i++)s(this,1),this.bytes[this.position]=t.charCodeAt(i),this.position++;s(this,2),this.view.setUint8(this.position,1),this.position++,this.view.setUint8(this.position,e?1:0),this.position++,this.length=Math.max(this.length,this.position),++n},this.finalize=function(){var t,i;switch(this.bytes[0]){case a.VIDEO_TAG:this.bytes[11]=7|(this.keyFrame||e?16:32),this.bytes[12]=e?0:1,t=this.pts-this.dts,this.bytes[13]=(16711680&t)>>>16,this.bytes[14]=(65280&t)>>>8,this.bytes[15]=(255&t)>>>0;break;case a.AUDIO_TAG:this.bytes[11]=175,this.bytes[12]=e?0:1;break;case a.METADATA_TAG:this.position=11,this.view.setUint8(this.position,2),this.position++,this.view.setUint16(this.position,10),this.position+=2,this.bytes.set([111,110,77,101,116,97,68,97,116,97],this.position),this.position+=10,this.bytes[this.position]=8,this.position++,this.view.setUint32(this.position,n),this.position=this.length,this.bytes.set([0,0,9],this.position),this.position+=3,this.length=this.position}return i=this.length-11,this.bytes[1]=(16711680&i)>>>16,this.bytes[2]=(65280&i)>>>8,this.bytes[3]=(255&i)>>>0,this.bytes[4]=(16711680&this.dts)>>>16,this.bytes[5]=(65280&this.dts)>>>8,this.bytes[6]=(255&this.dts)>>>0,this.bytes[7]=(4278190080&this.dts)>>>24,this.bytes[8]=0,this.bytes[9]=0,this.bytes[10]=0,s(this,4),this.view.setUint32(this.length,this.length),this.length+=4,this.position+=4,this.bytes=this.bytes.subarray(0,this.length),this.frameTime=a.frameTime(this.bytes),this}},a.AUDIO_TAG=8,a.VIDEO_TAG=9,a.METADATA_TAG=18,a.isAudioFrame=function(t){return a.AUDIO_TAG===t[0]},a.isVideoFrame=function(t){return a.VIDEO_TAG===t[0]},a.isMetaData=function(t){return a.METADATA_TAG===t[0]},a.isKeyFrame=function(t){return a.isVideoFrame(t)?23===t[11]:!!a.isAudioFrame(t)||!!a.isMetaData(t)},a.frameTime=function(t){var e=t[4]<<16;return e|=t[5]<<8,e|=t[6]<<0,e|=t[7]<<24},e.exports=a},{}],10:[function(t,e,i){e.exports={tag:t(9),Transmuxer:t(12),getFlvHeader:t(8)}},{}],11:[function(t,e,i){"use strict";var a=function(){var t=this;this.list=[],this.push=function(t){this.list.push({bytes:t.bytes,dts:t.dts,pts:t.pts,keyFrame:t.keyFrame,metaDataTag:t.metaDataTag})},Object.defineProperty(this,"length",{get:function(){return t.list.length}})};e.exports=a},{}],12:[function(t,e,i){"use strict";var a,n,r,s,o,h,d=t(30),p=t(9),u=t(16),c=t(3),l=t(4).H264Stream,f=t(7),m=t(11);s=function(t,e){"number"==typeof e.pts&&(void 0===t.timelineStartInfo.pts?t.timelineStartInfo.pts=e.pts:t.timelineStartInfo.pts=Math.min(t.timelineStartInfo.pts,e.pts)),"number"==typeof e.dts&&(void 0===t.timelineStartInfo.dts?t.timelineStartInfo.dts=e.dts:t.timelineStartInfo.dts=Math.min(t.timelineStartInfo.dts,e.dts))},o=function(t,e){var i=new p(p.METADATA_TAG);return i.dts=e,i.pts=e,i.writeMetaDataDouble("videocodecid",7),i.writeMetaDataDouble("width",t.width),i.writeMetaDataDouble("height",t.height),i},h=function(t,e){var i,a=new p(p.VIDEO_TAG,!0);for(a.dts=e,a.pts=e,a.writeByte(1),a.writeByte(t.profileIdc),a.writeByte(t.profileCompatibility),a.writeByte(t.levelIdc),a.writeByte(255),a.writeByte(225),a.writeShort(t.sps[0].length),a.writeBytes(t.sps[0]),a.writeByte(t.pps.length),i=0;i<t.pps.length;++i)a.writeShort(t.pps[i].length),a.writeBytes(t.pps[i]);return a},r=function(t){var e,i=[],a=[];r.prototype.init.call(this),this.push=function(e){s(t,e),t&&(t.audioobjecttype=e.audioobjecttype,t.channelcount=e.channelcount,t.samplerate=e.samplerate,t.samplingfrequencyindex=e.samplingfrequencyindex,t.samplesize=e.samplesize,t.extraData=t.audioobjecttype<<11|t.samplingfrequencyindex<<7|t.channelcount<<3),e.pts=Math.round(e.pts/90),e.dts=Math.round(e.dts/90),i.push(e)},this.flush=function(){var n,r,s,o=new m;if(0===i.length)return void this.trigger("done","AudioSegmentStream");for(s=-1/0;i.length;)n=i.shift(),a.length&&n.pts>=a[0]&&(s=a.shift(),this.writeMetaDataTags(o,s)),(t.extraData!==e||n.pts-s>=1e3)&&(this.writeMetaDataTags(o,n.pts),e=t.extraData,s=n.pts),r=new p(p.AUDIO_TAG),r.pts=n.pts,r.dts=n.dts,r.writeBytes(n.data),o.push(r.finalize());a.length=0,e=null,this.trigger("data",{track:t,tags:o.list}),this.trigger("done","AudioSegmentStream")},this.writeMetaDataTags=function(e,i){var a;a=new p(p.METADATA_TAG),a.pts=i,a.dts=i,a.writeMetaDataDouble("audiocodecid",10),a.writeMetaDataBoolean("stereo",2===t.channelcount),a.writeMetaDataDouble("audiosamplerate",t.samplerate),a.writeMetaDataDouble("audiosamplesize",16),e.push(a.finalize()),a=new p(p.AUDIO_TAG,!0),a.pts=i,a.dts=i,a.view.setUint16(a.position,t.extraData),a.position+=2,a.length=Math.max(a.length,a.position),e.push(a.finalize())},this.onVideoKeyFrame=function(t){a.push(t)}},r.prototype=new d,n=function(t){var e,i,a=[];n.prototype.init.call(this),this.finishFrame=function(a,n){if(n){if(e&&t&&t.newMetadata&&(n.keyFrame||0===a.length)){var r=o(e,n.dts).finalize(),s=h(t,n.dts).finalize();r.metaDataTag=s.metaDataTag=!0,a.push(r),a.push(s),t.newMetadata=!1,this.trigger("keyframe",n.dts)}n.endNalUnit(),a.push(n.finalize()),i=null}},this.push=function(e){s(t,e),e.pts=Math.round(e.pts/90),e.dts=Math.round(e.dts/90),a.push(e)},this.flush=function(){for(var n,r=new m;a.length&&"access_unit_delimiter_rbsp"!==a[0].nalUnitType;)a.shift();if(0===a.length)return void this.trigger("done","VideoSegmentStream");for(;a.length;)n=a.shift(),"seq_parameter_set_rbsp"===n.nalUnitType?(t.newMetadata=!0,e=n.config,t.width=e.width,t.height=e.height,t.sps=[n.data],t.profileIdc=e.profileIdc,t.levelIdc=e.levelIdc,t.profileCompatibility=e.profileCompatibility,i.endNalUnit()):"pic_parameter_set_rbsp"===n.nalUnitType?(t.newMetadata=!0,t.pps=[n.data],i.endNalUnit()):"access_unit_delimiter_rbsp"===n.nalUnitType?(i&&this.finishFrame(r,i),i=new p(p.VIDEO_TAG),i.pts=n.pts,i.dts=n.dts):("slice_layer_without_partitioning_rbsp_idr"===n.nalUnitType&&(i.keyFrame=!0),i.endNalUnit()),i.startNalUnit(),i.writeBytes(n.data);i&&this.finishFrame(r,i),this.trigger("data",{track:t,tags:r.list}),this.trigger("done","VideoSegmentStream")}},n.prototype=new d,a=function(t){var e,i,s,o,h,d,p,m,g,y,b,v,T=this;a.prototype.init.call(this),t=t||{},this.metadataStream=new u.MetadataStream,t.metadataStream=this.metadataStream,e=new u.TransportPacketStream,i=new u.TransportParseStream,s=new u.ElementaryStream,o=new u.TimestampRolloverStream("video"),h=new u.TimestampRolloverStream("audio"),d=new u.TimestampRolloverStream("timed-metadata"),p=new c,m=new l,v=new f(t),e.pipe(i).pipe(s),s.pipe(o).pipe(m),s.pipe(h).pipe(p),s.pipe(d).pipe(this.metadataStream).pipe(v),b=new u.CaptionStream,m.pipe(b).pipe(v),s.on("data",function(t){var e,i,a;if("metadata"===t.type){for(e=t.tracks.length;e--;)"video"===t.tracks[e].type?i=t.tracks[e]:"audio"===t.tracks[e].type&&(a=t.tracks[e]);i&&!g&&(v.numberOfTracks++,g=new n(i),m.pipe(g).pipe(v)),a&&!y&&(v.numberOfTracks++,y=new r(a),p.pipe(y).pipe(v),g&&g.on("keyframe",y.onVideoKeyFrame))}}),this.push=function(t){e.push(t)},this.flush=function(){e.flush()},this.resetCaptions=function(){b.reset()},v.on("data",function(t){T.trigger("data",t)}),v.on("done",function(){T.trigger("done")})},a.prototype=new d,e.exports=a},{}],13:[function(t,e,i){"use strict";var a={codecs:t(5),mp4:t(21),flv:t(10),mp2t:t(15)};a.mp4.tools=t(26),a.flv.tools=t(25),a.mp2t.tools=t(27),e.exports=a},{}],14:[function(t,e,i){"use strict";var a=t(30),n=function(t){for(var e=0,i={payloadType:-1,payloadSize:0},a=0,n=0;e<t.byteLength&&128!==t[e];){for(;255===t[e];)a+=255,e++;for(a+=t[e++];255===t[e];)n+=255,e++;if(n+=t[e++],!i.payload&&4===a){i.payloadType=a,i.payloadSize=n,i.payload=t.subarray(e,e+n);break}e+=n,a=0,n=0}return i},r=function(t){return 181!==t.payload[0]?null:49!=(t.payload[1]<<8|t.payload[2])?null:"GA94"!==String.fromCharCode(t.payload[3],t.payload[4],t.payload[5],t.payload[6])?null:3!==t.payload[7]?null:t.payload.subarray(8,t.payload.length-1)},s=function(t,e){var i,a,n,r,s=[];if(!(64&e[0]))return s;for(a=31&e[0],i=0;i<a;i++)n=3*i,r={type:3&e[n+2],pts:t},4&e[n+2]&&(r.ccData=e[n+3]<<8|e[n+4],s.push(r));return s},o={push:function(){}},h=function(){h.prototype.init.call(this),this.captionPackets_=[],this.ccStreams_=[new l(0,0),new l(0,1),new l(1,0),new l(1,1)],this.reset(),this.ccStreams_.forEach(function(t){t.on("data",this.trigger.bind(this,"data")),t.on("done",this.trigger.bind(this,"done"))},this)};h.prototype=new a,h.prototype.push=function(t){var e,i;if("sei_rbsp"===t.nalUnitType&&(e=n(t.escapedRBSP),4===e.payloadType&&(i=r(e)))){if(t.dts<this.latestDts_)return void(this.ignoreNextEqualDts_=!0);if(t.dts===this.latestDts_&&this.ignoreNextEqualDts_)return void(this.ignoreNextEqualDts_=!1);this.captionPackets_=this.captionPackets_.concat(s(t.pts,i)),this.latestDts_=t.dts}},h.prototype.flush=function(){if(!this.captionPackets_.length)return void this.ccStreams_.forEach(function(t){t.flush()},this);this.captionPackets_.forEach(function(t,e){t.presortIndex=e}),this.captionPackets_.sort(function(t,e){return t.pts===e.pts?t.presortIndex-e.presortIndex:t.pts-e.pts}),this.captionPackets_.forEach(function(t){t.type<2&&this.dispatchCea608Packet(t)},this),this.captionPackets_.length=0,this.ccStreams_.forEach(function(t){t.flush()},this)},h.prototype.reset=function(){this.latestDts_=null,this.ignoreNextEqualDts_=!1,this.activeCea608Channel_=null,this.activeCea608Streams_=[o,o],this.ccStreams_.forEach(function(t){t.reset()})},h.prototype.dispatchCea608Packet=function(t){this.setsChannel1Active(t)&&1!==this.activeCea608Channel_?(this.activeCea608Channel_=1,this.activeCea608Streams_=[this.ccStreams_[0],this.ccStreams_[2]]):this.setsChannel2Active(t)&&2!==this.activeCea608Channel_&&(this.activeCea608Channel_=2,this.activeCea608Streams_=[this.ccStreams_[1],this.ccStreams_[3]]),this.activeCea608Streams_[t.type].push(t)},h.prototype.setsChannel1Active=function(t){return 4096==(30720&t.ccData)},h.prototype.setsChannel2Active=function(t){return 6144==(30720&t.ccData)};var d={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,304:174,305:176,306:189,307:191,308:8482,309:162,310:163,311:9834,312:224,313:160,314:232,315:226,316:234,317:238,318:244,319:251,544:193,545:201,546:211,547:218,548:220,549:252,550:8216,551:161,552:42,553:39,554:8212,555:169,556:8480,557:8226,558:8220,559:8221,560:192,561:194,562:199,563:200,564:202,565:203,566:235,567:206,568:207,569:239,570:212,571:217,572:249,573:219,574:171,575:187,800:195,801:227,802:205,803:204,804:236,805:210,806:242,807:213,808:245,809:123,810:125,811:92,812:94,813:95,814:124,815:126,816:196,817:228,818:214,819:246,820:223,821:165,822:164,823:9474,824:197,825:229,826:216,827:248,828:9484,829:9488,830:9492,831:9496},p=function(t){return null===t?"":(t=d[t]||t,String.fromCharCode(t))},u=[4352,4384,4608,4640,5376,5408,5632,5664,5888,5920,4096,4864,4896,5120,5152],c=function(){for(var t=[],e=15;e--;)t.push("");return t},l=function(t,e){l.prototype.init.call(this),this.field_=t||0,this.dataChannel_=e||0,this.name_="CC"+(1+(this.field_<<1|this.dataChannel_)),this.setConstants(),this.reset(),this.push=function(t){var e,i,a,n,r;if((e=32639&t.ccData)===this.lastControlCode_)return void(this.lastControlCode_=null);if(4096==(61440&e)?this.lastControlCode_=e:e!==this.PADDING_&&(this.lastControlCode_=null),a=e>>>8,n=255&e,e!==this.PADDING_)if(e===this.RESUME_CAPTION_LOADING_)this.mode_="popOn";else if(e===this.END_OF_CAPTION_)this.clearFormatting(t.pts),this.flushDisplayed(t.pts),i=this.displayed_,this.displayed_=this.nonDisplayed_,this.nonDisplayed_=i,this.startPts_=t.pts;else if(e===this.ROLL_UP_2_ROWS_)this.topRow_=13,this.mode_="rollUp";else if(e===this.ROLL_UP_3_ROWS_)this.topRow_=12,this.mode_="rollUp";else if(e===this.ROLL_UP_4_ROWS_)this.topRow_=11,this.mode_="rollUp";else if(e===this.CARRIAGE_RETURN_)this.clearFormatting(t.pts),this.flushDisplayed(t.pts),this.shiftRowsUp_(),this.startPts_=t.pts;else if(e===this.BACKSPACE_)"popOn"===this.mode_?this.nonDisplayed_[14]=this.nonDisplayed_[14].slice(0,-1):this.displayed_[14]=this.displayed_[14].slice(0,-1);else if(e===this.ERASE_DISPLAYED_MEMORY_)this.flushDisplayed(t.pts),this.displayed_=c();else if(e===this.ERASE_NON_DISPLAYED_MEMORY_)this.nonDisplayed_=c();else if(e===this.RESUME_DIRECT_CAPTIONING_)this.mode_="paintOn";else if(this.isSpecialCharacter(a,n))a=(3&a)<<8,r=p(a|n),this[this.mode_](t.pts,r),this.column_++;else if(this.isExtCharacter(a,n))"popOn"===this.mode_?this.nonDisplayed_[this.row_]=this.nonDisplayed_[this.row_].slice(0,-1):this.displayed_[14]=this.displayed_[14].slice(0,-1),a=(3&a)<<8,r=p(a|n),this[this.mode_](t.pts,r),this.column_++;else if(this.isMidRowCode(a,n))this.clearFormatting(t.pts),this[this.mode_](t.pts," "),this.column_++,14==(14&n)&&this.addFormatting(t.pts,["i"]),1==(1&n)&&this.addFormatting(t.pts,["u"]);else if(this.isOffsetControlCode(a,n))this.column_+=3&n;else if(this.isPAC(a,n)){var s=u.indexOf(7968&e);s!==this.row_&&(this.clearFormatting(t.pts),this.row_=s),1&n&&-1===this.formatting_.indexOf("u")&&this.addFormatting(t.pts,["u"]),16==(16&e)&&(this.column_=4*((14&e)>>1)),this.isColorPAC(n)&&14==(14&n)&&this.addFormatting(t.pts,["i"])}else this.isNormalChar(a)&&(0===n&&(n=null),r=p(a),r+=p(n),this[this.mode_](t.pts,r),this.column_+=r.length)}};l.prototype=new a,l.prototype.flushDisplayed=function(t){var e=this.displayed_.map(function(t){return t.trim()}).join("\n").replace(/^\n+|\n+$/g,"");e.length&&this.trigger("data",{startPts:this.startPts_,endPts:t,text:e,stream:this.name_})},l.prototype.reset=function(){this.mode_="popOn",this.topRow_=0,this.startPts_=0,this.displayed_=c(),this.nonDisplayed_=c(),this.lastControlCode_=null,this.column_=0,this.row_=14,this.formatting_=[]},l.prototype.setConstants=function(){0===this.dataChannel_?(this.BASE_=16,this.EXT_=17,this.CONTROL_=(20|this.field_)<<8,this.OFFSET_=23):1===this.dataChannel_&&(this.BASE_=24,this.EXT_=25,this.CONTROL_=(28|this.field_)<<8,this.OFFSET_=31),this.PADDING_=0,this.RESUME_CAPTION_LOADING_=32|this.CONTROL_,this.END_OF_CAPTION_=47|this.CONTROL_,this.ROLL_UP_2_ROWS_=37|this.CONTROL_,this.ROLL_UP_3_ROWS_=38|this.CONTROL_,this.ROLL_UP_4_ROWS_=39|this.CONTROL_,this.CARRIAGE_RETURN_=45|this.CONTROL_,this.RESUME_DIRECT_CAPTIONING_=41|this.CONTROL_,this.BACKSPACE_=33|this.CONTROL_,this.ERASE_DISPLAYED_MEMORY_=44|this.CONTROL_,this.ERASE_NON_DISPLAYED_MEMORY_=46|this.CONTROL_},l.prototype.isSpecialCharacter=function(t,e){return t===this.EXT_&&e>=48&&e<=63},l.prototype.isExtCharacter=function(t,e){return(t===this.EXT_+1||t===this.EXT_+2)&&e>=32&&e<=63},l.prototype.isMidRowCode=function(t,e){return t===this.EXT_&&e>=32&&e<=47},l.prototype.isOffsetControlCode=function(t,e){return t===this.OFFSET_&&e>=33&&e<=35},l.prototype.isPAC=function(t,e){return t>=this.BASE_&&t<this.BASE_+8&&e>=64&&e<=127},l.prototype.isColorPAC=function(t){return t>=64&&t<=79||t>=96&&t<=127},l.prototype.isNormalChar=function(t){return t>=32&&t<=127},l.prototype.addFormatting=function(t,e){this.formatting_=this.formatting_.concat(e);var i=e.reduce(function(t,e){return t+"<"+e+">"},"");this[this.mode_](t,i)},l.prototype.clearFormatting=function(t){if(this.formatting_.length){var e=this.formatting_.reverse().reduce(function(t,e){return t+"</"+e+">"},"");this.formatting_=[],this[this.mode_](t,e)}},l.prototype.popOn=function(t,e){var i=this.nonDisplayed_[this.row_];i+=e,this.nonDisplayed_[this.row_]=i},l.prototype.rollUp=function(t,e){var i=this.displayed_[14];i+=e,this.displayed_[14]=i},l.prototype.shiftRowsUp_=function(){var t;for(t=0;t<this.topRow_;t++)this.displayed_[t]="";for(t=this.topRow_;t<14;t++)this.displayed_[t]=this.displayed_[t+1];this.displayed_[14]=""},l.prototype.paintOn=function(){},e.exports={CaptionStream:h,Cea608Stream:l}},{}],15:[function(t,e,i){e.exports=t(16)},{}],16:[function(t,e,i){"use strict";var a,n,r,s=t(30),o=t(14),h=t(19),d=t(20).TimestampRolloverStream,p=t(19);a=function(){var t=new Uint8Array(188),e=0;a.prototype.init.call(this),this.push=function(i){var a,n=0,r=188;for(e?(a=new Uint8Array(i.byteLength+e),a.set(t.subarray(0,e)),a.set(i,e),e=0):a=i;r<a.byteLength;)71!==a[n]||71!==a[r]?(n++,r++):(this.trigger("data",a.subarray(n,r)),n+=188,r+=188);n<a.byteLength&&(t.set(a.subarray(n),0),e=a.byteLength-n)},this.flush=function(){188===e&&71===t[0]&&(this.trigger("data",t),e=0),this.trigger("done")}},a.prototype=new s,n=function(){var t,e,i,a;n.prototype.init.call(this),a=this,this.packetsWaitingForPmt=[],this.programMapTable=void 0,t=function(t,a){var n=0;a.payloadUnitStartIndicator&&(n+=t[n]+1),"pat"===a.type?e(t.subarray(n),a):i(t.subarray(n),a)},e=function(t,e){e.section_number=t[7],e.last_section_number=t[8],a.pmtPid=(31&t[10])<<8|t[11],e.pmtPid=a.pmtPid},i=function(t,e){var i,n,r,s;if(1&t[5]){for(a.programMapTable={},i=(15&t[1])<<8|t[2],n=3+i-4,r=(15&t[10])<<8|t[11],s=12+r;s<n;)a.programMapTable[(31&t[s+1])<<8|t[s+2]]=t[s],s+=5+((15&t[s+3])<<8|t[s+4]);for(e.programMapTable=a.programMapTable;a.packetsWaitingForPmt.length;)a.processPes_.apply(a,a.packetsWaitingForPmt.shift())}},this.push=function(e){var i={},a=4;i.payloadUnitStartIndicator=!!(64&e[1]),i.pid=31&e[1],i.pid<<=8,i.pid|=e[2],(48&e[3])>>>4>1&&(a+=e[a]+1),0===i.pid?(i.type="pat",t(e.subarray(a),i),this.trigger("data",i)):i.pid===this.pmtPid?(i.type="pmt",t(e.subarray(a),i),this.trigger("data",i)):void 0===this.programMapTable?this.packetsWaitingForPmt.push([e,a,i]):this.processPes_(e,a,i)},this.processPes_=function(t,e,i){i.streamType=this.programMapTable[i.pid],i.type="pes",i.data=t.subarray(e),this.trigger("data",i)}},n.prototype=new s,n.STREAM_TYPES={h264:27,adts:15},r=function(){var t=this,e={data:[],size:0},i={data:[],size:0},a={data:[],size:0},n=function(t,e){var i;e.packetLength=6+(t[4]<<8|t[5]),e.dataAlignmentIndicator=0!=(4&t[6]),i=t[7],192&i&&(e.pts=(14&t[9])<<27|(255&t[10])<<20|(254&t[11])<<12|(255&t[12])<<5|(254&t[13])>>>3,e.pts*=4,e.pts+=(6&t[13])>>>1,e.dts=e.pts,64&i&&(e.dts=(14&t[14])<<27|(255&t[15])<<20|(254&t[16])<<12|(255&t[17])<<5|(254&t[18])>>>3,e.dts*=4,e.dts+=(6&t[18])>>>1)),e.data=t.subarray(9+t[8])},s=function(e,i,a){var r,s=new Uint8Array(e.size),o={type:i},h=0,d=0,p=!1;if(e.data.length&&!(e.size<9)){for(o.trackId=e.data[0].pid,h=0;h<e.data.length;h++)r=e.data[h],s.set(r.data,d),d+=r.data.byteLength;n(s,o),p="video"===i||o.packetLength===e.size,(a||p)&&(e.size=0,e.data.length=0),p&&t.trigger("data",o)}};r.prototype.init.call(this),this.push=function(n){({pat:function(){},pes:function(){var t,r;switch(n.streamType){case h.H264_STREAM_TYPE:case p.H264_STREAM_TYPE:t=e,r="video";break;case h.ADTS_STREAM_TYPE:t=i,r="audio";break;case h.METADATA_STREAM_TYPE:t=a,r="timed-metadata";break;default:return}n.payloadUnitStartIndicator&&s(t,r,!0),t.data.push(n),t.size+=n.data.byteLength},pmt:function(){var e,i,a={type:"metadata",tracks:[]},r=n.programMapTable;for(e in r)r.hasOwnProperty(e)&&(i={timelineStartInfo:{baseMediaDecodeTime:0
}},i.id=+e,r[e]===p.H264_STREAM_TYPE?(i.codec="avc",i.type="video"):r[e]===p.ADTS_STREAM_TYPE&&(i.codec="adts",i.type="audio"),a.tracks.push(i));t.trigger("data",a)}})[n.type]()},this.flush=function(){s(e,"video"),s(i,"audio"),s(a,"timed-metadata"),this.trigger("done")}},r.prototype=new s;var u={PAT_PID:0,MP2T_PACKET_LENGTH:188,TransportPacketStream:a,TransportParseStream:n,ElementaryStream:r,TimestampRolloverStream:d,CaptionStream:o.CaptionStream,Cea608Stream:o.Cea608Stream,MetadataStream:t(17)};for(var c in h)h.hasOwnProperty(c)&&(u[c]=h[c]);e.exports=u},{}],17:[function(t,e,i){"use strict";var a,n=t(30),r=t(19),s=function(t,e,i){var a,n="";for(a=e;a<i;a++)n+="%"+("00"+t[a].toString(16)).slice(-2);return n},o=function(t,e,i){return decodeURIComponent(s(t,e,i))},h=function(t,e,i){return unescape(s(t,e,i))},d=function(t){return t[0]<<21|t[1]<<14|t[2]<<7|t[3]},p={TXXX:function(t){var e;if(3===t.data[0]){for(e=1;e<t.data.length;e++)if(0===t.data[e]){t.description=o(t.data,1,e),t.value=o(t.data,e+1,t.data.length).replace(/\0*$/,"");break}t.data=t.value}},WXXX:function(t){var e;if(3===t.data[0])for(e=1;e<t.data.length;e++)if(0===t.data[e]){t.description=o(t.data,1,e),t.url=o(t.data,e+1,t.data.length);break}},PRIV:function(t){var e;for(e=0;e<t.data.length;e++)if(0===t.data[e]){t.owner=h(t.data,0,e);break}t.privateData=t.data.subarray(e+1),t.data=t.privateData}};a=function(t){var e,i={debug:!(!t||!t.debug),descriptor:t&&t.descriptor},n=0,s=[],o=0;if(a.prototype.init.call(this),this.dispatchType=r.METADATA_STREAM_TYPE.toString(16),i.descriptor)for(e=0;e<i.descriptor.length;e++)this.dispatchType+=("00"+i.descriptor[e].toString(16)).slice(-2);this.push=function(t){var e,a,r,h,u,c;if("timed-metadata"===t.type){if(t.dataAlignmentIndicator&&(o=0,s.length=0),0===s.length&&(t.data.length<10||t.data[0]!=="I".charCodeAt(0)||t.data[1]!=="D".charCodeAt(0)||t.data[2]!=="3".charCodeAt(0)))return void(i.debug&&console.log("Skipping unrecognized metadata packet"));if(s.push(t),o+=t.data.byteLength,1===s.length&&(n=d(t.data.subarray(6,10)),n+=10),!(o<n)){for(e={data:new Uint8Array(n),frames:[],pts:s[0].pts,dts:s[0].dts},u=0;u<n;)e.data.set(s[0].data.subarray(0,n-u),u),u+=s[0].data.byteLength,o-=s[0].data.byteLength,s.shift();a=10,64&e.data[5]&&(a+=4,a+=d(e.data.subarray(10,14)),n-=d(e.data.subarray(16,20)));do{if((r=d(e.data.subarray(a+4,a+8)))<1)return console.log("Malformed ID3 frame encountered. Skipping metadata parsing.");if(c=String.fromCharCode(e.data[a],e.data[a+1],e.data[a+2],e.data[a+3]),h={id:c,data:e.data.subarray(a+10,a+r+10)},h.key=h.id,p[h.id]&&(p[h.id](h),"com.apple.streaming.transportStreamTimestamp"===h.owner)){var l=h.data,f=(1&l[3])<<30|l[4]<<22|l[5]<<14|l[6]<<6|l[7]>>>2;f*=4,f+=3&l[7],h.timeStamp=f,void 0===e.pts&&void 0===e.dts&&(e.pts=h.timeStamp,e.dts=h.timeStamp),this.trigger("timestamp",h)}e.frames.push(h),a+=10,a+=r}while(a<n);this.trigger("data",e)}}}},a.prototype=new n,e.exports=a},{}],18:[function(t,e,i){"use strict";var a=t(19),n=function(t){var e=31&t[1];return e<<=8,e|=t[2]},r=function(t){return!!(64&t[1])},s=function(t){var e=0;return(48&t[3])>>>4>1&&(e+=t[4]+1),e},o=function(t,e){var i=n(t);return 0===i?"pat":i===e?"pmt":e?"pes":null},h=function(t){var e=r(t),i=4+s(t);return e&&(i+=t[i]+1),(31&t[i+10])<<8|t[i+11]},d=function(t){var e={},i=r(t),a=4+s(t);if(i&&(a+=t[a]+1),1&t[a+5]){var n,o,h;n=(15&t[a+1])<<8|t[a+2],o=3+n-4,h=(15&t[a+10])<<8|t[a+11];for(var d=12+h;d<o;){var p=a+d;e[(31&t[p+1])<<8|t[p+2]]=t[p],d+=5+((15&t[p+3])<<8|t[p+4])}return e}},p=function(t,e){switch(e[n(t)]){case a.H264_STREAM_TYPE:return"video";case a.ADTS_STREAM_TYPE:return"audio";case a.METADATA_STREAM_TYPE:return"timed-metadata";default:return null}},u=function(t){if(!r(t))return null;var e=4+s(t);if(e>=t.byteLength)return null;var i,a=null;return i=t[e+7],192&i&&(a={},a.pts=(14&t[e+9])<<27|(255&t[e+10])<<20|(254&t[e+11])<<12|(255&t[e+12])<<5|(254&t[e+13])>>>3,a.pts*=4,a.pts+=(6&t[e+13])>>>1,a.dts=a.pts,64&i&&(a.dts=(14&t[e+14])<<27|(255&t[e+15])<<20|(254&t[e+16])<<12|(255&t[e+17])<<5|(254&t[e+18])>>>3,a.dts*=4,a.dts+=(6&t[e+18])>>>1)),a},c=function(t){switch(t){case 5:return"slice_layer_without_partitioning_rbsp_idr";case 6:return"sei_rbsp";case 7:return"seq_parameter_set_rbsp";case 8:return"pic_parameter_set_rbsp";case 9:return"access_unit_delimiter_rbsp";default:return null}},l=function(t){for(var e,i=4+s(t),a=t.subarray(i),n=0,r=0,o=!1;r<a.byteLength-3;r++)if(1===a[r+2]){n=r+5;break}for(;n<a.byteLength;)switch(a[n]){case 0:if(0!==a[n-1]){n+=2;break}if(0!==a[n-2]){n++;break}r+3!==n-2&&"slice_layer_without_partitioning_rbsp_idr"===(e=c(31&a[r+3]))&&(o=!0);do{n++}while(1!==a[n]&&n<a.length);r=n-2,n+=3;break;case 1:if(0!==a[n-1]||0!==a[n-2]){n+=3;break}e=c(31&a[r+3]),"slice_layer_without_partitioning_rbsp_idr"===e&&(o=!0),r=n-2,n+=3;break;default:n+=3}return a=a.subarray(r),n-=r,r=0,a&&a.byteLength>3&&"slice_layer_without_partitioning_rbsp_idr"===(e=c(31&a[r+3]))&&(o=!0),o};e.exports={parseType:o,parsePat:h,parsePmt:d,parsePayloadUnitStartIndicator:r,parsePesType:p,parsePesTime:u,videoPacketContainsKeyFrame:l}},{}],19:[function(t,e,i){"use strict";e.exports={H264_STREAM_TYPE:27,ADTS_STREAM_TYPE:15,METADATA_STREAM_TYPE:21}},{}],20:[function(t,e,i){"use strict";var a=t(30),n=function(t,e){var i=1;for(t>e&&(i=-1);Math.abs(e-t)>4294967296;)t+=8589934592*i;return t},r=function(t){var e,i;r.prototype.init.call(this),this.type_=t,this.push=function(t){t.type===this.type_&&(void 0===i&&(i=t.dts),t.dts=n(t.dts,i),t.pts=n(t.pts,i),e=t.dts,this.trigger("data",t))},this.flush=function(){i=e,this.trigger("done")},this.discontinuity=function(){i=void 0,e=void 0}};r.prototype=new a,e.exports={TimestampRolloverStream:r,handleRollover:n}},{}],21:[function(t,e,i){e.exports={generator:t(22),Transmuxer:t(24).Transmuxer,AudioSegmentStream:t(24).AudioSegmentStream,VideoSegmentStream:t(24).VideoSegmentStream}},{}],22:[function(t,e,i){"use strict";var a,n,r,s,o,h,d,p,u,c,l,f,m,g,y,b,v,T,S,_,w,U,A,k,D,C,L,x,P,M,O,E,I,R,B,F,z=Math.pow(2,32)-1;!function(){var t;if(A={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],mvex:[],mvhd:[],sdtp:[],smhd:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],styp:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[]},"undefined"!=typeof Uint8Array){for(t in A)A.hasOwnProperty(t)&&(A[t]=[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3)]);k=new Uint8Array(["i".charCodeAt(0),"s".charCodeAt(0),"o".charCodeAt(0),"m".charCodeAt(0)]),C=new Uint8Array(["a".charCodeAt(0),"v".charCodeAt(0),"c".charCodeAt(0),"1".charCodeAt(0)]),D=new Uint8Array([0,0,0,1]),L=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),x=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]),P={video:L,audio:x},E=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),O=new Uint8Array([0,0,0,0,0,0,0,0]),I=new Uint8Array([0,0,0,0,0,0,0,0]),R=I,B=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),F=I,M=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0])}}(),a=function(t){var e,i,a,n=[],r=0;for(e=1;e<arguments.length;e++)n.push(arguments[e]);for(e=n.length;e--;)r+=n[e].byteLength;for(i=new Uint8Array(r+8),a=new DataView(i.buffer,i.byteOffset,i.byteLength),a.setUint32(0,i.byteLength),i.set(t,4),e=0,r=8;e<n.length;e++)i.set(n[e],r),r+=n[e].byteLength;return i},n=function(){return a(A.dinf,a(A.dref,E))},r=function(t){return a(A.esds,new Uint8Array([0,0,0,0,3,25,0,0,0,4,17,64,21,0,6,0,0,0,218,192,0,0,218,192,5,2,t.audioobjecttype<<3|t.samplingfrequencyindex>>>1,t.samplingfrequencyindex<<7|t.channelcount<<3,6,1,2]))},s=function(){return a(A.ftyp,k,D,k,C)},b=function(t){return a(A.hdlr,P[t])},o=function(t){return a(A.mdat,t)},y=function(t){var e=new Uint8Array([0,0,0,0,0,0,0,2,0,0,0,3,0,1,95,144,t.duration>>>24&255,t.duration>>>16&255,t.duration>>>8&255,255&t.duration,85,196,0,0]);return t.samplerate&&(e[12]=t.samplerate>>>24&255,e[13]=t.samplerate>>>16&255,e[14]=t.samplerate>>>8&255,e[15]=255&t.samplerate),a(A.mdhd,e)},g=function(t){return a(A.mdia,y(t),b(t.type),d(t))},h=function(t){return a(A.mfhd,new Uint8Array([0,0,0,0,(4278190080&t)>>24,(16711680&t)>>16,(65280&t)>>8,255&t]))},d=function(t){return a(A.minf,"video"===t.type?a(A.vmhd,M):a(A.smhd,O),n(),T(t))},p=function(t,e){for(var i=[],n=e.length;n--;)i[n]=_(e[n]);return a.apply(null,[A.moof,h(t)].concat(i))},u=function(t){for(var e=t.length,i=[];e--;)i[e]=f(t[e]);return a.apply(null,[A.moov,l(4294967295)].concat(i).concat(c(t)))},c=function(t){for(var e=t.length,i=[];e--;)i[e]=w(t[e]);return a.apply(null,[A.mvex].concat(i))},l=function(t){var e=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,2,0,1,95,144,(4278190080&t)>>24,(16711680&t)>>16,(65280&t)>>8,255&t,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return a(A.mvhd,e)},v=function(t){var e,i,n=t.samples||[],r=new Uint8Array(4+n.length);for(i=0;i<n.length;i++)e=n[i].flags,r[i+4]=e.dependsOn<<4|e.isDependedOn<<2|e.hasRedundancy;return a(A.sdtp,r)},T=function(t){return a(A.stbl,S(t),a(A.stts,F),a(A.stsc,R),a(A.stsz,B),a(A.stco,I))},function(){var t,e;S=function(i){return a(A.stsd,new Uint8Array([0,0,0,0,0,0,0,1]),"video"===i.type?t(i):e(i))},t=function(t){var e,i=t.sps||[],n=t.pps||[],r=[],s=[];for(e=0;e<i.length;e++)r.push((65280&i[e].byteLength)>>>8),r.push(255&i[e].byteLength),r=r.concat(Array.prototype.slice.call(i[e]));for(e=0;e<n.length;e++)s.push((65280&n[e].byteLength)>>>8),s.push(255&n[e].byteLength),s=s.concat(Array.prototype.slice.call(n[e]));return a(A.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,(65280&t.width)>>8,255&t.width,(65280&t.height)>>8,255&t.height,0,72,0,0,0,72,0,0,0,0,0,0,0,1,19,118,105,100,101,111,106,115,45,99,111,110,116,114,105,98,45,104,108,115,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),a(A.avcC,new Uint8Array([1,t.profileIdc,t.profileCompatibility,t.levelIdc,255].concat([i.length]).concat(r).concat([n.length]).concat(s))),a(A.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])))},e=function(t){return a(A.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,(65280&t.channelcount)>>8,255&t.channelcount,(65280&t.samplesize)>>8,255&t.samplesize,0,0,0,0,(65280&t.samplerate)>>8,255&t.samplerate,0,0]),r(t))}}(),m=function(t){var e=new Uint8Array([0,0,0,7,0,0,0,0,0,0,0,0,(4278190080&t.id)>>24,(16711680&t.id)>>16,(65280&t.id)>>8,255&t.id,0,0,0,0,(4278190080&t.duration)>>24,(16711680&t.duration)>>16,(65280&t.duration)>>8,255&t.duration,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,(65280&t.width)>>8,255&t.width,0,0,(65280&t.height)>>8,255&t.height,0,0]);return a(A.tkhd,e)},_=function(t){var e,i,n,r,s,o,h;return e=a(A.tfhd,new Uint8Array([0,0,0,58,(4278190080&t.id)>>24,(16711680&t.id)>>16,(65280&t.id)>>8,255&t.id,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0])),o=Math.floor(t.baseMediaDecodeTime/(z+1)),h=Math.floor(t.baseMediaDecodeTime%(z+1)),i=a(A.tfdt,new Uint8Array([1,0,0,0,o>>>24&255,o>>>16&255,o>>>8&255,255&o,h>>>24&255,h>>>16&255,h>>>8&255,255&h])),s=92,"audio"===t.type?(n=U(t,s),a(A.traf,e,i,n)):(r=v(t),n=U(t,r.length+s),a(A.traf,e,i,n,r))},f=function(t){return t.duration=t.duration||4294967295,a(A.trak,m(t),g(t))},w=function(t){var e=new Uint8Array([0,0,0,0,(4278190080&t.id)>>24,(16711680&t.id)>>16,(65280&t.id)>>8,255&t.id,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]);return"video"!==t.type&&(e[e.length-1]=0),a(A.trex,e)},function(){var t,e,i;i=function(t,e){var i=0,a=0,n=0,r=0;return t.length&&(void 0!==t[0].duration&&(i=1),void 0!==t[0].size&&(a=2),void 0!==t[0].flags&&(n=4),void 0!==t[0].compositionTimeOffset&&(r=8)),[0,0,i|a|n|r,1,(4278190080&t.length)>>>24,(16711680&t.length)>>>16,(65280&t.length)>>>8,255&t.length,(4278190080&e)>>>24,(16711680&e)>>>16,(65280&e)>>>8,255&e]},e=function(t,e){var n,r,s,o;for(r=t.samples||[],e+=20+16*r.length,n=i(r,e),o=0;o<r.length;o++)s=r[o],n=n.concat([(4278190080&s.duration)>>>24,(16711680&s.duration)>>>16,(65280&s.duration)>>>8,255&s.duration,(4278190080&s.size)>>>24,(16711680&s.size)>>>16,(65280&s.size)>>>8,255&s.size,s.flags.isLeading<<2|s.flags.dependsOn,s.flags.isDependedOn<<6|s.flags.hasRedundancy<<4|s.flags.paddingValue<<1|s.flags.isNonSyncSample,61440&s.flags.degradationPriority,15&s.flags.degradationPriority,(4278190080&s.compositionTimeOffset)>>>24,(16711680&s.compositionTimeOffset)>>>16,(65280&s.compositionTimeOffset)>>>8,255&s.compositionTimeOffset]);return a(A.trun,new Uint8Array(n))},t=function(t,e){var n,r,s,o;for(r=t.samples||[],e+=20+8*r.length,n=i(r,e),o=0;o<r.length;o++)s=r[o],n=n.concat([(4278190080&s.duration)>>>24,(16711680&s.duration)>>>16,(65280&s.duration)>>>8,255&s.duration,(4278190080&s.size)>>>24,(16711680&s.size)>>>16,(65280&s.size)>>>8,255&s.size]);return a(A.trun,new Uint8Array(n))},U=function(i,a){return"audio"===i.type?t(i,a):e(i,a)}}(),e.exports={ftyp:s,mdat:o,moof:p,moov:u,initSegment:function(t){var e,i=s(),a=u(t);return e=new Uint8Array(i.byteLength+a.byteLength),e.set(i),e.set(a,i.byteLength),e}}},{}],23:[function(t,e,i){"use strict";var a,n,r,s;a=function(t,e){var i,r,s,o,h,d=[];if(!e.length)return null;for(i=0;i<t.byteLength;)r=t[i]<<24,r|=t[i+1]<<16,r|=t[i+2]<<8,r|=t[i+3],s=n(t.subarray(i+4,i+8)),o=r>1?i+r:t.byteLength,s===e[0]&&(1===e.length?d.push(t.subarray(i+8,o)):(h=a(t.subarray(i+8,o),e.slice(1)),h.length&&(d=d.concat(h)))),i=o;return d},n=function(t){var e="";return e+=String.fromCharCode(t[0]),e+=String.fromCharCode(t[1]),e+=String.fromCharCode(t[2]),e+=String.fromCharCode(t[3])},r=function(t){var e={};return a(t,["moov","trak"]).reduce(function(t,e){var i,n,r,s,o;return(i=a(e,["tkhd"])[0])?(n=i[0],r=0===n?12:20,s=i[r]<<24|i[r+1]<<16|i[r+2]<<8|i[r+3],(o=a(e,["mdia","mdhd"])[0])?(n=o[0],r=0===n?12:20,t[s]=o[r]<<24|o[r+1]<<16|o[r+2]<<8|o[r+3],t):null):null},e)},s=function(t,e){var i,n,r;return i=a(e,["moof","traf"]),n=[].concat.apply([],i.map(function(e){return a(e,["tfhd"]).map(function(i){var n,r,s;return n=i[4]<<24|i[5]<<16|i[6]<<8|i[7],r=t[n]||9e4,s=a(e,["tfdt"]).map(function(t){var e,i;return e=t[0],i=t[4]<<24|t[5]<<16|t[6]<<8|t[7],1===e&&(i*=Math.pow(2,32),i+=t[8]<<24|t[9]<<16|t[10]<<8|t[11]),i})[0],(s=s||1/0)/r})})),r=Math.min.apply(null,n),isFinite(r)?r:0},e.exports={parseType:n,timescale:r,startTime:s}},{}],24:[function(t,e,i){"use strict";var a,n,r,s,o,h,d,p,u,c,l,f=t(30),m=t(22),g=t(16),y=t(3),b=t(4).H264Stream,v=t(1),T=t(6),S=t(28),_=["audioobjecttype","channelcount","samplerate","samplingfrequencyindex","samplesize"],w=["width","height","profileIdc","levelIdc","profileCompatibility"];o=function(){return{size:0,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0,degradationPriority:0}}},h=function(t){return t[0]==="I".charCodeAt(0)&&t[1]==="D".charCodeAt(0)&&t[2]==="3".charCodeAt(0)},c=function(t,e){var i;if(t.length!==e.length)return!1;for(i=0;i<t.length;i++)if(t[i]!==e[i])return!1;return!0},l=function(t){var e,i,a=0;for(e=0;e<t.length;e++)i=t[e],a+=i.data.byteLength;return a},n=function(t){var e=[],i=0,a=0,r=0,s=1/0;n.prototype.init.call(this),this.push=function(i){d(t,i),t&&_.forEach(function(e){t[e]=i[e]}),e.push(i)},this.setEarliestDts=function(e){a=e-t.timelineStartInfo.baseMediaDecodeTime},this.setVideoBaseMediaDecodeTime=function(t){s=t},this.setAudioAppendStart=function(t){r=t},this.flush=function(){var a,n,r,s;if(0===e.length)return void this.trigger("done","AudioSegmentStream");a=this.trimAdtsFramesByEarliestDts_(e),t.baseMediaDecodeTime=u(t),this.prefixWithSilence_(t,a),t.samples=this.generateSampleTable_(a),r=m.mdat(this.concatenateFrameData_(a)),e=[],n=m.moof(i,[t]),s=new Uint8Array(n.byteLength+r.byteLength),i++,s.set(n),s.set(r,n.byteLength),p(t),this.trigger("data",{track:t,boxes:s}),this.trigger("done","AudioSegmentStream")},this.prefixWithSilence_=function(t,e){var i,a,n,o=0,h=0,d=0,p=0;if(e.length&&(i=S.audioTsToVideoTs(t.baseMediaDecodeTime,t.samplerate),o=Math.ceil(9e4/(t.samplerate/1024)),r&&s&&(h=i-Math.max(r,s),d=Math.floor(h/o),p=d*o),!(d<1||p>45e3))){for(a=T[t.samplerate],a||(a=e[0].data),n=0;n<d;n++)e.splice(n,0,{data:a});t.baseMediaDecodeTime-=Math.floor(S.videoTsToAudioTs(p,t.samplerate))}},this.trimAdtsFramesByEarliestDts_=function(e){return t.minSegmentDts>=a?e:(t.minSegmentDts=1/0,e.filter(function(e){return e.dts>=a&&(t.minSegmentDts=Math.min(t.minSegmentDts,e.dts),t.minSegmentPts=t.minSegmentDts,!0)}))},this.generateSampleTable_=function(t){var e,i,a=[];for(e=0;e<t.length;e++)i=t[e],a.push({size:i.data.byteLength,duration:1024});return a},this.concatenateFrameData_=function(t){var e,i,a=0,n=new Uint8Array(l(t));for(e=0;e<t.length;e++)i=t[e],n.set(i.data,a),a+=i.data.byteLength;return n}},n.prototype=new f,a=function(t){var e,i,n=0,r=[];a.prototype.init.call(this),delete t.minPTS,this.gopCache_=[],this.push=function(a){d(t,a),"seq_parameter_set_rbsp"!==a.nalUnitType||e||(e=a.config,t.sps=[a.data],w.forEach(function(i){t[i]=e[i]},this)),"pic_parameter_set_rbsp"!==a.nalUnitType||i||(i=a.data,t.pps=[a.data]),r.push(a)},this.flush=function(){for(var e,i,a,s,o,h;r.length&&"access_unit_delimiter_rbsp"!==r[0].nalUnitType;)r.shift();if(0===r.length)return this.resetStream_(),void this.trigger("done","VideoSegmentStream");e=this.groupNalsIntoFrames_(r),a=this.groupFramesIntoGops_(e),a[0][0].keyFrame||(i=this.getGopForFusion_(r[0],t),i?(a.unshift(i),a.byteLength+=i.byteLength,a.nalCount+=i.nalCount,a.pts=i.pts,a.dts=i.dts,a.duration+=i.duration):a=this.extendFirstKeyFrame_(a)),d(t,a),t.samples=this.generateSampleTable_(a),o=m.mdat(this.concatenateNalData_(a)),this.gopCache_.unshift({gop:a.pop(),pps:t.pps,sps:t.sps}),this.gopCache_.length=Math.min(6,this.gopCache_.length),r=[],t.baseMediaDecodeTime=u(t),this.trigger("baseMediaDecodeTime",t.baseMediaDecodeTime),this.trigger("timelineStartInfo",t.timelineStartInfo),s=m.moof(n,[t]),h=new Uint8Array(s.byteLength+o.byteLength),n++,h.set(s),h.set(o,s.byteLength),this.trigger("data",{track:t,boxes:h}),this.resetStream_(),this.trigger("done","VideoSegmentStream")},this.resetStream_=function(){p(t),e=void 0,i=void 0},this.getGopForFusion_=function(e){var i,a,n,r,s,o=1/0;for(s=0;s<this.gopCache_.length;s++)r=this.gopCache_[s],n=r.gop,t.pps&&c(t.pps[0],r.pps[0])&&t.sps&&c(t.sps[0],r.sps[0])&&(n.dts<t.timelineStartInfo.dts||(i=e.dts-n.dts-n.duration)>=-1e4&&i<=45e3&&(!a||o>i)&&(a=r,o=i));return a?a.gop:null},this.extendFirstKeyFrame_=function(t){var e;return!t[0][0].keyFrame&&t.length>1&&(e=t.shift(),t.byteLength-=e.byteLength,t.nalCount-=e.nalCount,t[0][0].dts=e.dts,t[0][0].pts=e.pts,t[0][0].duration+=e.duration),t},this.groupNalsIntoFrames_=function(t){var e,i,a=[],n=[];for(a.byteLength=0,e=0;e<t.length;e++)i=t[e],"access_unit_delimiter_rbsp"===i.nalUnitType?(a.length&&(a.duration=i.dts-a.dts,n.push(a)),a=[i],a.byteLength=i.data.byteLength,a.pts=i.pts,a.dts=i.dts):("slice_layer_without_partitioning_rbsp_idr"===i.nalUnitType&&(a.keyFrame=!0),a.duration=i.dts-a.dts,a.byteLength+=i.data.byteLength,a.push(i));return n.length&&(!a.duration||a.duration<=0)&&(a.duration=n[n.length-1].duration),n.push(a),n},this.groupFramesIntoGops_=function(t){var e,i,a=[],n=[];for(a.byteLength=0,a.nalCount=0,a.duration=0,a.pts=t[0].pts,a.dts=t[0].dts,n.byteLength=0,n.nalCount=0,n.duration=0,n.pts=t[0].pts,n.dts=t[0].dts,e=0;e<t.length;e++)i=t[e],i.keyFrame?(a.length&&(n.push(a),n.byteLength+=a.byteLength,n.nalCount+=a.nalCount,n.duration+=a.duration),a=[i],a.nalCount=i.length,a.byteLength=i.byteLength,a.pts=i.pts,a.dts=i.dts,a.duration=i.duration):(a.duration+=i.duration,a.nalCount+=i.length,a.byteLength+=i.byteLength,a.push(i));return n.length&&a.duration<=0&&(a.duration=n[n.length-1].duration),n.byteLength+=a.byteLength,n.nalCount+=a.nalCount,n.duration+=a.duration,n.push(a),n},this.generateSampleTable_=function(t,e){var i,a,n,r,s,h=e||0,d=[];for(i=0;i<t.length;i++)for(r=t[i],a=0;a<r.length;a++)s=r[a],n=o(),n.dataOffset=h,n.compositionTimeOffset=s.pts-s.dts,n.duration=s.duration,n.size=4*s.length,n.size+=s.byteLength,s.keyFrame&&(n.flags.dependsOn=2),h+=n.size,d.push(n);return d},this.concatenateNalData_=function(t){var e,i,a,n,r,s,o=0,h=t.byteLength,d=t.nalCount,p=h+4*d,u=new Uint8Array(p),c=new DataView(u.buffer);for(e=0;e<t.length;e++)for(n=t[e],i=0;i<n.length;i++)for(r=n[i],a=0;a<r.length;a++)s=r[a],c.setUint32(o,s.data.byteLength),o+=4,u.set(s.data,o),o+=s.data.byteLength;return u}},a.prototype=new f,d=function(t,e){"number"==typeof e.pts&&(void 0===t.timelineStartInfo.pts&&(t.timelineStartInfo.pts=e.pts),void 0===t.minSegmentPts?t.minSegmentPts=e.pts:t.minSegmentPts=Math.min(t.minSegmentPts,e.pts),void 0===t.maxSegmentPts?t.maxSegmentPts=e.pts:t.maxSegmentPts=Math.max(t.maxSegmentPts,e.pts)),"number"==typeof e.dts&&(void 0===t.timelineStartInfo.dts&&(t.timelineStartInfo.dts=e.dts),void 0===t.minSegmentDts?t.minSegmentDts=e.dts:t.minSegmentDts=Math.min(t.minSegmentDts,e.dts),void 0===t.maxSegmentDts?t.maxSegmentDts=e.dts:t.maxSegmentDts=Math.max(t.maxSegmentDts,e.dts))},p=function(t){delete t.minSegmentDts,delete t.maxSegmentDts,delete t.minSegmentPts,delete t.maxSegmentPts},u=function(t){var e,i,a=t.minSegmentDts-t.timelineStartInfo.dts;return e=t.timelineStartInfo.baseMediaDecodeTime,e+=a,e=Math.max(0,e),"audio"===t.type&&(i=t.samplerate/9e4,e*=i,e=Math.floor(e)),e},s=function(t,e){this.numberOfTracks=0,this.metadataStream=e,void 0!==t.remux?this.remuxTracks=!!t.remux:this.remuxTracks=!0,this.pendingTracks=[],this.videoTrack=null,this.pendingBoxes=[],this.pendingCaptions=[],this.pendingMetadata=[],this.pendingBytes=0,this.emittedTracks=0,s.prototype.init.call(this),this.push=function(t){return t.text?this.pendingCaptions.push(t):t.frames?this.pendingMetadata.push(t):(this.pendingTracks.push(t.track),this.pendingBoxes.push(t.boxes),this.pendingBytes+=t.boxes.byteLength,"video"===t.track.type&&(this.videoTrack=t.track),void("audio"===t.track.type&&(this.audioTrack=t.track)))}},s.prototype=new f,s.prototype.flush=function(t){var e,i,a,n,r=0,s={captions:[],captionStreams:{},metadata:[],info:{}},o=0;if(this.pendingTracks.length<this.numberOfTracks){if("VideoSegmentStream"!==t&&"AudioSegmentStream"!==t)return;if(this.remuxTracks)return;if(0===this.pendingTracks.length)return void(++this.emittedTracks>=this.numberOfTracks&&(this.trigger("done"),this.emittedTracks=0))}for(this.videoTrack?(o=this.videoTrack.timelineStartInfo.pts,w.forEach(function(t){s.info[t]=this.videoTrack[t]},this)):this.audioTrack&&(o=this.audioTrack.timelineStartInfo.pts,_.forEach(function(t){s.info[t]=this.audioTrack[t]},this)),1===this.pendingTracks.length?s.type=this.pendingTracks[0].type:s.type="combined",this.emittedTracks+=this.pendingTracks.length,a=m.initSegment(this.pendingTracks),s.initSegment=new Uint8Array(a.byteLength),s.initSegment.set(a),s.data=new Uint8Array(this.pendingBytes),n=0;n<this.pendingBoxes.length;n++)s.data.set(this.pendingBoxes[n],r),r+=this.pendingBoxes[n].byteLength;for(n=0;n<this.pendingCaptions.length;n++)e=this.pendingCaptions[n],e.startTime=e.startPts-o,e.startTime/=9e4,e.endTime=e.endPts-o,e.endTime/=9e4,s.captionStreams[e.stream]=!0,s.captions.push(e);for(n=0;n<this.pendingMetadata.length;n++)i=this.pendingMetadata[n],i.cueTime=i.pts-o,i.cueTime/=9e4,s.metadata.push(i);s.metadata.dispatchType=this.metadataStream.dispatchType,this.pendingTracks.length=0,this.videoTrack=null,this.pendingBoxes.length=0,this.pendingCaptions.length=0,this.pendingBytes=0,this.pendingMetadata.length=0,this.trigger("data",s),this.emittedTracks>=this.numberOfTracks&&(this.trigger("done"),this.emittedTracks=0)},r=function(t){var e,i,o=this,d=!0;r.prototype.init.call(this),t=t||{},this.baseMediaDecodeTime=t.baseMediaDecodeTime||0,this.transmuxPipeline_={},this.setupAacPipeline=function(){var e={};this.transmuxPipeline_=e,e.type="aac",e.metadataStream=new g.MetadataStream,e.aacStream=new v,e.audioTimestampRolloverStream=new g.TimestampRolloverStream("audio"),e.timedMetadataTimestampRolloverStream=new g.TimestampRolloverStream("timed-metadata"),e.adtsStream=new y,e.coalesceStream=new s(t,e.metadataStream),e.headOfPipeline=e.aacStream,e.aacStream.pipe(e.audioTimestampRolloverStream).pipe(e.adtsStream),e.aacStream.pipe(e.timedMetadataTimestampRolloverStream).pipe(e.metadataStream).pipe(e.coalesceStream),e.metadataStream.on("timestamp",function(t){e.aacStream.setTimestamp(t.timeStamp)}),e.aacStream.on("data",function(t){"timed-metadata"!==t.type||e.audioSegmentStream||(i=i||{timelineStartInfo:{baseMediaDecodeTime:o.baseMediaDecodeTime},codec:"adts",type:"audio"},e.coalesceStream.numberOfTracks++,e.audioSegmentStream=new n(i),e.adtsStream.pipe(e.audioSegmentStream).pipe(e.coalesceStream))}),e.coalesceStream.on("data",this.trigger.bind(this,"data")),e.coalesceStream.on("done",this.trigger.bind(this,"done"))},this.setupTsPipeline=function(){var r={};this.transmuxPipeline_=r,r.type="ts",r.metadataStream=new g.MetadataStream,r.packetStream=new g.TransportPacketStream,r.parseStream=new g.TransportParseStream,r.elementaryStream=new g.ElementaryStream,r.videoTimestampRolloverStream=new g.TimestampRolloverStream("video"),r.audioTimestampRolloverStream=new g.TimestampRolloverStream("audio"),r.timedMetadataTimestampRolloverStream=new g.TimestampRolloverStream("timed-metadata"),r.adtsStream=new y,r.h264Stream=new b,r.captionStream=new g.CaptionStream,r.coalesceStream=new s(t,r.metadataStream),r.headOfPipeline=r.packetStream,r.packetStream.pipe(r.parseStream).pipe(r.elementaryStream),r.elementaryStream.pipe(r.videoTimestampRolloverStream).pipe(r.h264Stream),r.elementaryStream.pipe(r.audioTimestampRolloverStream).pipe(r.adtsStream),r.elementaryStream.pipe(r.timedMetadataTimestampRolloverStream).pipe(r.metadataStream).pipe(r.coalesceStream),r.h264Stream.pipe(r.captionStream).pipe(r.coalesceStream),r.elementaryStream.on("data",function(t){var s;if("metadata"===t.type){for(s=t.tracks.length;s--;)e||"video"!==t.tracks[s].type?i||"audio"!==t.tracks[s].type||(i=t.tracks[s],i.timelineStartInfo.baseMediaDecodeTime=o.baseMediaDecodeTime):(e=t.tracks[s],e.timelineStartInfo.baseMediaDecodeTime=o.baseMediaDecodeTime);e&&!r.videoSegmentStream&&(r.coalesceStream.numberOfTracks++,r.videoSegmentStream=new a(e),r.videoSegmentStream.on("timelineStartInfo",function(t){i&&(i.timelineStartInfo=t,r.audioSegmentStream.setEarliestDts(t.dts))}),r.videoSegmentStream.on("baseMediaDecodeTime",function(t){i&&r.audioSegmentStream.setVideoBaseMediaDecodeTime(t)}),r.h264Stream.pipe(r.videoSegmentStream).pipe(r.coalesceStream)),i&&!r.audioSegmentStream&&(r.coalesceStream.numberOfTracks++,r.audioSegmentStream=new n(i),r.adtsStream.pipe(r.audioSegmentStream).pipe(r.coalesceStream))}}),r.coalesceStream.on("data",this.trigger.bind(this,"data")),r.coalesceStream.on("done",this.trigger.bind(this,"done"))},this.setBaseMediaDecodeTime=function(t){var a=this.transmuxPipeline_;this.baseMediaDecodeTime=t,i&&(i.timelineStartInfo.dts=void 0,i.timelineStartInfo.pts=void 0,p(i),i.timelineStartInfo.baseMediaDecodeTime=t,a.audioTimestampRolloverStream&&a.audioTimestampRolloverStream.discontinuity()),e&&(a.videoSegmentStream&&(a.videoSegmentStream.gopCache_=[],a.videoTimestampRolloverStream.discontinuity()),e.timelineStartInfo.dts=void 0,e.timelineStartInfo.pts=void 0,p(e),a.captionStream.reset(),e.timelineStartInfo.baseMediaDecodeTime=t),a.timedMetadataTimestampRolloverStream&&a.timedMetadataTimestampRolloverStream.discontinuity()},this.setAudioAppendStart=function(t){i&&this.transmuxPipeline_.audioSegmentStream.setAudioAppendStart(t)},this.push=function(t){if(d){var e=h(t);e&&"aac"!==this.transmuxPipeline_.type?this.setupAacPipeline():e||"ts"===this.transmuxPipeline_.type||this.setupTsPipeline(),d=!1}this.transmuxPipeline_.headOfPipeline.push(t)},this.flush=function(){d=!0,this.transmuxPipeline_.headOfPipeline.flush()},this.resetCaptions=function(){this.transmuxPipeline_.captionStream&&this.transmuxPipeline_.captionStream.reset()}},r.prototype=new f,e.exports={Transmuxer:r,VideoSegmentStream:a,AudioSegmentStream:n,AUDIO_PROPERTIES:_,VIDEO_PROPERTIES:w}},{}],25:[function(t,e,i){"use strict";var a={8:"audio",9:"video",18:"metadata"},n=function(t){return"0x"+("00"+t.toString(16)).slice(-2).toUpperCase()},r=function(t){for(var e,i=[];t.byteLength>0;)e=0,i.push(n(t[e++])),t=t.subarray(e);return i.join(" ")},s=function(t,e){var i=["AVC Sequence Header","AVC NALU","AVC End-of-Sequence"],a=t[1]&parseInt("01111111",2)<<16|t[2]<<8|t[3];return e=e||{},e.avcPacketType=i[t[0]],e.CompositionTime=t[1]&parseInt("10000000",2)?-a:a,1===t[0]?e.nalUnitTypeRaw=r(t.subarray(4,100)):e.data=r(t.subarray(4)),e},o=function(t,e){var i=["Unknown","Keyframe (for AVC, a seekable frame)","Inter frame (for AVC, a nonseekable frame)","Disposable inter frame (H.263 only)","Generated keyframe (reserved for server use only)","Video info/command frame"],a=t[0]&parseInt("00001111",2);return e=e||{},e.frameType=i[(t[0]&parseInt("11110000",2))>>>4],e.codecID=a,7===a?s(t.subarray(1),e):e},h=function(t,e){var i=["AAC Sequence Header","AAC Raw"];return e=e||{},e.aacPacketType=i[t[0]],e.data=r(t.subarray(1)),e},d=function(t,e){var i=["Linear PCM, platform endian","ADPCM","MP3","Linear PCM, little endian","Nellymoser 16-kHz mono","Nellymoser 8-kHz mono","Nellymoser","G.711 A-law logarithmic PCM","G.711 mu-law logarithmic PCM","reserved","AAC","Speex","MP3 8-Khz","Device-specific sound"],a=["5.5-kHz","11-kHz","22-kHz","44-kHz"],n=(t[0]&parseInt("11110000",2))>>>4;return e=e||{},e.soundFormat=i[n],e.soundRate=a[(t[0]&parseInt("00001100",2))>>>2],e.soundSize=(t[0]&parseInt("00000010",2))>>>1?"16-bit":"8-bit",e.soundType=t[0]&parseInt("00000001",2)?"Stereo":"Mono",10===n?h(t.subarray(1),e):e},p=function(t){return{tagType:a[t[0]],dataSize:t[1]<<16|t[2]<<8|t[3],timestamp:t[7]<<24|t[4]<<16|t[5]<<8|t[6],streamID:t[8]<<16|t[9]<<8|t[10]}},u=function(t){var e=p(t);switch(t[0]){case 8:d(t.subarray(11),e);break;case 9:o(t.subarray(11),e)}return e},c=function(t){var e,i,a=9,n=[];for(a+=4;a<t.byteLength;)e=t[a+1]<<16,e|=t[a+2]<<8,e|=t[a+3],e+=11,i=t.subarray(a,a+e),n.push(u(i)),a+=e+4;return n},l=function(t){return JSON.stringify(t,null,2)};e.exports={inspectTag:u,inspect:c,textify:l}},{}],26:[function(t,e,i){(function(i){"use strict";var a,n,r=t(23).parseType,s=function(t){return new Date(1e3*t-20828448e5)},o=function(t){return{isLeading:(12&t[0])>>>2,dependsOn:3&t[0],isDependedOn:(192&t[1])>>>6,hasRedundancy:(48&t[1])>>>4,paddingValue:(14&t[1])>>>1,isNonSyncSample:1&t[1],degradationPriority:t[2]<<8|t[3]}},h=function(t){var e,i,a=new DataView(t.buffer,t.byteOffset,t.byteLength),n=[];for(e=0;e+4<t.length;e+=i)if(i=a.getUint32(e),e+=4,i<=0)n.push("<span style='color:red;'>MALFORMED DATA</span>");else switch(31&t[e]){case 1:n.push("slice_layer_without_partitioning_rbsp");break;case 5:n.push("slice_layer_without_partitioning_rbsp_idr");break;case 6:n.push("sei_rbsp");break;case 7:n.push("seq_parameter_set_rbsp");break;case 8:n.push("pic_parameter_set_rbsp");break;case 9:n.push("access_unit_delimiter_rbsp");break;default:n.push("UNKNOWN NAL - "+t[e]&31)}return n},d={avc1:function(t){var e=new DataView(t.buffer,t.byteOffset,t.byteLength);return{dataReferenceIndex:e.getUint16(6),width:e.getUint16(24),height:e.getUint16(26),horizresolution:e.getUint16(28)+e.getUint16(30)/16,vertresolution:e.getUint16(32)+e.getUint16(34)/16,frameCount:e.getUint16(40),depth:e.getUint16(74),config:a(t.subarray(78,t.byteLength))}},avcC:function(t){var e,i,a,n,r=new DataView(t.buffer,t.byteOffset,t.byteLength),s={configurationVersion:t[0],avcProfileIndication:t[1],profileCompatibility:t[2],avcLevelIndication:t[3],lengthSizeMinusOne:3&t[4],sps:[],pps:[]},o=31&t[5];for(a=6,n=0;n<o;n++)i=r.getUint16(a),a+=2,s.sps.push(new Uint8Array(t.subarray(a,a+i))),a+=i;for(e=t[a],a++,n=0;n<e;n++)i=r.getUint16(a),a+=2,s.pps.push(new Uint8Array(t.subarray(a,a+i))),a+=i;return s},btrt:function(t){
var e=new DataView(t.buffer,t.byteOffset,t.byteLength);return{bufferSizeDB:e.getUint32(0),maxBitrate:e.getUint32(4),avgBitrate:e.getUint32(8)}},esds:function(t){return{version:t[0],flags:new Uint8Array(t.subarray(1,4)),esId:t[6]<<8|t[7],streamPriority:31&t[8],decoderConfig:{objectProfileIndication:t[11],streamType:t[12]>>>2&63,bufferSize:t[13]<<16|t[14]<<8|t[15],maxBitrate:t[16]<<24|t[17]<<16|t[18]<<8|t[19],avgBitrate:t[20]<<24|t[21]<<16|t[22]<<8|t[23],decoderConfigDescriptor:{tag:t[24],length:t[25],audioObjectType:t[26]>>>3&31,samplingFrequencyIndex:(7&t[26])<<1|t[27]>>>7&1,channelConfiguration:t[27]>>>3&15}}}},ftyp:function(t){for(var e=new DataView(t.buffer,t.byteOffset,t.byteLength),i={majorBrand:r(t.subarray(0,4)),minorVersion:e.getUint32(4),compatibleBrands:[]},a=8;a<t.byteLength;)i.compatibleBrands.push(r(t.subarray(a,a+4))),a+=4;return i},dinf:function(t){return{boxes:a(t)}},dref:function(t){return{version:t[0],flags:new Uint8Array(t.subarray(1,4)),dataReferences:a(t.subarray(8))}},hdlr:function(t){var e=new DataView(t.buffer,t.byteOffset,t.byteLength),a={version:e.getUint8(0),flags:new Uint8Array(t.subarray(1,4)),handlerType:r(t.subarray(8,12)),name:""},n=8;for(n=24;n<t.byteLength;n++){if(0===t[n]){n++;break}a.name+=String.fromCharCode(t[n])}return a.name=decodeURIComponent(i.escape(a.name)),a},mdat:function(t){return{byteLength:t.byteLength,nals:h(t)}},mdhd:function(t){var e,i=new DataView(t.buffer,t.byteOffset,t.byteLength),a=4,n={version:i.getUint8(0),flags:new Uint8Array(t.subarray(1,4)),language:""};return 1===n.version?(a+=4,n.creationTime=s(i.getUint32(a)),a+=8,n.modificationTime=s(i.getUint32(a)),a+=4,n.timescale=i.getUint32(a),a+=8,n.duration=i.getUint32(a)):(n.creationTime=s(i.getUint32(a)),a+=4,n.modificationTime=s(i.getUint32(a)),a+=4,n.timescale=i.getUint32(a),a+=4,n.duration=i.getUint32(a)),a+=4,e=i.getUint16(a),n.language+=String.fromCharCode(96+(e>>10)),n.language+=String.fromCharCode(96+((960&e)>>5)),n.language+=String.fromCharCode(96+(31&e)),n},mdia:function(t){return{boxes:a(t)}},mfhd:function(t){return{version:t[0],flags:new Uint8Array(t.subarray(1,4)),sequenceNumber:t[4]<<24|t[5]<<16|t[6]<<8|t[7]}},minf:function(t){return{boxes:a(t)}},mp4a:function(t){var e=new DataView(t.buffer,t.byteOffset,t.byteLength),i={dataReferenceIndex:e.getUint16(6),channelcount:e.getUint16(16),samplesize:e.getUint16(18),samplerate:e.getUint16(24)+e.getUint16(26)/65536};return t.byteLength>28&&(i.streamDescriptor=a(t.subarray(28))[0]),i},moof:function(t){return{boxes:a(t)}},moov:function(t){return{boxes:a(t)}},mvex:function(t){return{boxes:a(t)}},mvhd:function(t){var e=new DataView(t.buffer,t.byteOffset,t.byteLength),i=4,a={version:e.getUint8(0),flags:new Uint8Array(t.subarray(1,4))};return 1===a.version?(i+=4,a.creationTime=s(e.getUint32(i)),i+=8,a.modificationTime=s(e.getUint32(i)),i+=4,a.timescale=e.getUint32(i),i+=8,a.duration=e.getUint32(i)):(a.creationTime=s(e.getUint32(i)),i+=4,a.modificationTime=s(e.getUint32(i)),i+=4,a.timescale=e.getUint32(i),i+=4,a.duration=e.getUint32(i)),i+=4,a.rate=e.getUint16(i)+e.getUint16(i+2)/16,i+=4,a.volume=e.getUint8(i)+e.getUint8(i+1)/8,i+=2,i+=2,i+=8,a.matrix=new Uint32Array(t.subarray(i,i+36)),i+=36,i+=24,a.nextTrackId=e.getUint32(i),a},pdin:function(t){var e=new DataView(t.buffer,t.byteOffset,t.byteLength);return{version:e.getUint8(0),flags:new Uint8Array(t.subarray(1,4)),rate:e.getUint32(4),initialDelay:e.getUint32(8)}},sdtp:function(t){var e,i={version:t[0],flags:new Uint8Array(t.subarray(1,4)),samples:[]};for(e=4;e<t.byteLength;e++)i.samples.push({dependsOn:(48&t[e])>>4,isDependedOn:(12&t[e])>>2,hasRedundancy:3&t[e]});return i},sidx:function(t){var e,i=new DataView(t.buffer,t.byteOffset,t.byteLength),a={version:t[0],flags:new Uint8Array(t.subarray(1,4)),references:[],referenceId:i.getUint32(4),timescale:i.getUint32(8),earliestPresentationTime:i.getUint32(12),firstOffset:i.getUint32(16)},n=i.getUint16(22);for(e=24;n;e+=12,n--)a.references.push({referenceType:(128&t[e])>>>7,referencedSize:2147483647&i.getUint32(e),subsegmentDuration:i.getUint32(e+4),startsWithSap:!!(128&t[e+8]),sapType:(112&t[e+8])>>>4,sapDeltaTime:268435455&i.getUint32(e+8)});return a},smhd:function(t){return{version:t[0],flags:new Uint8Array(t.subarray(1,4)),balance:t[4]+t[5]/256}},stbl:function(t){return{boxes:a(t)}},stco:function(t){var e,i=new DataView(t.buffer,t.byteOffset,t.byteLength),a={version:t[0],flags:new Uint8Array(t.subarray(1,4)),chunkOffsets:[]},n=i.getUint32(4);for(e=8;n;e+=4,n--)a.chunkOffsets.push(i.getUint32(e));return a},stsc:function(t){var e,i=new DataView(t.buffer,t.byteOffset,t.byteLength),a=i.getUint32(4),n={version:t[0],flags:new Uint8Array(t.subarray(1,4)),sampleToChunks:[]};for(e=8;a;e+=12,a--)n.sampleToChunks.push({firstChunk:i.getUint32(e),samplesPerChunk:i.getUint32(e+4),sampleDescriptionIndex:i.getUint32(e+8)});return n},stsd:function(t){return{version:t[0],flags:new Uint8Array(t.subarray(1,4)),sampleDescriptions:a(t.subarray(8))}},stsz:function(t){var e,i=new DataView(t.buffer,t.byteOffset,t.byteLength),a={version:t[0],flags:new Uint8Array(t.subarray(1,4)),sampleSize:i.getUint32(4),entries:[]};for(e=12;e<t.byteLength;e+=4)a.entries.push(i.getUint32(e));return a},stts:function(t){var e,i=new DataView(t.buffer,t.byteOffset,t.byteLength),a={version:t[0],flags:new Uint8Array(t.subarray(1,4)),timeToSamples:[]},n=i.getUint32(4);for(e=8;n;e+=8,n--)a.timeToSamples.push({sampleCount:i.getUint32(e),sampleDelta:i.getUint32(e+4)});return a},styp:function(t){return d.ftyp(t)},tfdt:function(t){var e={version:t[0],flags:new Uint8Array(t.subarray(1,4)),baseMediaDecodeTime:t[4]<<24|t[5]<<16|t[6]<<8|t[7]};return 1===e.version&&(e.baseMediaDecodeTime*=Math.pow(2,32),e.baseMediaDecodeTime+=t[8]<<24|t[9]<<16|t[10]<<8|t[11]),e},tfhd:function(t){var e,i=new DataView(t.buffer,t.byteOffset,t.byteLength),a={version:t[0],flags:new Uint8Array(t.subarray(1,4)),trackId:i.getUint32(4)},n=1&a.flags[2],r=2&a.flags[2],s=8&a.flags[2],o=16&a.flags[2],h=32&a.flags[2];return e=8,n&&(e+=4,a.baseDataOffset=i.getUint32(12),e+=4),r&&(a.sampleDescriptionIndex=i.getUint32(e),e+=4),s&&(a.defaultSampleDuration=i.getUint32(e),e+=4),o&&(a.defaultSampleSize=i.getUint32(e),e+=4),h&&(a.defaultSampleFlags=i.getUint32(e)),a},tkhd:function(t){var e=new DataView(t.buffer,t.byteOffset,t.byteLength),i=4,a={version:e.getUint8(0),flags:new Uint8Array(t.subarray(1,4))};return 1===a.version?(i+=4,a.creationTime=s(e.getUint32(i)),i+=8,a.modificationTime=s(e.getUint32(i)),i+=4,a.trackId=e.getUint32(i),i+=4,i+=8,a.duration=e.getUint32(i)):(a.creationTime=s(e.getUint32(i)),i+=4,a.modificationTime=s(e.getUint32(i)),i+=4,a.trackId=e.getUint32(i),i+=4,i+=4,a.duration=e.getUint32(i)),i+=4,i+=8,a.layer=e.getUint16(i),i+=2,a.alternateGroup=e.getUint16(i),i+=2,a.volume=e.getUint8(i)+e.getUint8(i+1)/8,i+=2,i+=2,a.matrix=new Uint32Array(t.subarray(i,i+36)),i+=36,a.width=e.getUint16(i)+e.getUint16(i+2)/16,i+=4,a.height=e.getUint16(i)+e.getUint16(i+2)/16,a},traf:function(t){return{boxes:a(t)}},trak:function(t){return{boxes:a(t)}},trex:function(t){var e=new DataView(t.buffer,t.byteOffset,t.byteLength);return{version:t[0],flags:new Uint8Array(t.subarray(1,4)),trackId:e.getUint32(4),defaultSampleDescriptionIndex:e.getUint32(8),defaultSampleDuration:e.getUint32(12),defaultSampleSize:e.getUint32(16),sampleDependsOn:3&t[20],sampleIsDependedOn:(192&t[21])>>6,sampleHasRedundancy:(48&t[21])>>4,samplePaddingValue:(14&t[21])>>1,sampleIsDifferenceSample:!!(1&t[21]),sampleDegradationPriority:e.getUint16(22)}},trun:function(t){var e,i={version:t[0],flags:new Uint8Array(t.subarray(1,4)),samples:[]},a=new DataView(t.buffer,t.byteOffset,t.byteLength),n=1&i.flags[2],r=4&i.flags[2],s=1&i.flags[1],h=2&i.flags[1],d=4&i.flags[1],p=8&i.flags[1],u=a.getUint32(4),c=8;for(n&&(i.dataOffset=a.getUint32(c),c+=4),r&&u&&(e={flags:o(t.subarray(c,c+4))},c+=4,s&&(e.duration=a.getUint32(c),c+=4),h&&(e.size=a.getUint32(c),c+=4),p&&(e.compositionTimeOffset=a.getUint32(c),c+=4),i.samples.push(e),u--);u--;)e={},s&&(e.duration=a.getUint32(c),c+=4),h&&(e.size=a.getUint32(c),c+=4),d&&(e.flags=o(t.subarray(c,c+4)),c+=4),p&&(e.compositionTimeOffset=a.getUint32(c),c+=4),i.samples.push(e);return i},"url ":function(t){return{version:t[0],flags:new Uint8Array(t.subarray(1,4))}},vmhd:function(t){var e=new DataView(t.buffer,t.byteOffset,t.byteLength);return{version:t[0],flags:new Uint8Array(t.subarray(1,4)),graphicsmode:e.getUint16(4),opcolor:new Uint16Array([e.getUint16(6),e.getUint16(8),e.getUint16(10)])}}};a=function(t){for(var e,i,a,n,s,o=0,h=[],p=new ArrayBuffer(t.length),u=new Uint8Array(p),c=0;c<t.length;++c)u[c]=t[c];for(e=new DataView(p);o<t.byteLength;)i=e.getUint32(o),a=r(t.subarray(o+4,o+8)),n=i>1?o+i:t.byteLength,s=(d[a]||function(t){return{data:t}})(t.subarray(o+8,n)),s.size=i,s.type=a,h.push(s),o=n;return h},n=function(t,e){var i;return e=e||0,i=new Array(2*e+1).join(" "),t.map(function(t,a){return i+t.type+"\n"+Object.keys(t).filter(function(t){return"type"!==t&&"boxes"!==t}).map(function(e){var a=i+"  "+e+": ",n=t[e];if(n instanceof Uint8Array||n instanceof Uint32Array){var r=Array.prototype.slice.call(new Uint8Array(n.buffer,n.byteOffset,n.byteLength)).map(function(t){return" "+("00"+t.toString(16)).slice(-2)}).join("").match(/.{1,24}/g);return r?1===r.length?a+"<"+r.join("").slice(1)+">":a+"<\n"+r.map(function(t){return i+"  "+t}).join("\n")+"\n"+i+"  >":a+"<>"}return a+JSON.stringify(n,null,2).split("\n").map(function(t,e){return 0===e?t:i+"  "+t}).join("\n")}).join("\n")+(t.boxes?"\n"+n(t.boxes,e+1):"")}).join("\n")},e.exports={inspect:a,textify:n}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],27:[function(t,e,i){"use strict";var a=t(19),n=t(20).handleRollover,r={};r.ts=t(18),r.aac=t(2);var s=function(t){return t[0]==="I".charCodeAt(0)&&t[1]==="D".charCodeAt(0)&&t[2]==="3".charCodeAt(0)},o=function(t,e){for(var i,a=0,n=188;n<t.byteLength;)if(71!==t[a]||71!==t[n])a++,n++;else{switch(i=t.subarray(a,n),r.ts.parseType(i,e.pid)){case"pat":e.pid||(e.pid=r.ts.parsePat(i));break;case"pmt":e.table||(e.table=r.ts.parsePmt(i))}if(e.pid&&e.table)return;a+=188,n+=188}},h=function(t,e,i){for(var a,n,s,o,h=0,d=188,p=!1;d<t.byteLength;)if(71!==t[h]||71!==t[d])h++,d++;else{switch(a=t.subarray(h,d),r.ts.parseType(a,e.pid)){case"pes":n=r.ts.parsePesType(a,e.table),s=r.ts.parsePayloadUnitStartIndicator(a),"audio"===n&&s&&(o=r.ts.parsePesTime(a))&&(o.type="audio",i.audio.push(o),p=!0)}if(p)break;h+=188,d+=188}for(d=t.byteLength,h=d-188,p=!1;h>=0;)if(71!==t[h]||71!==t[d])h--,d--;else{switch(a=t.subarray(h,d),r.ts.parseType(a,e.pid)){case"pes":n=r.ts.parsePesType(a,e.table),s=r.ts.parsePayloadUnitStartIndicator(a),"audio"===n&&s&&(o=r.ts.parsePesTime(a))&&(o.type="audio",i.audio.push(o),p=!0)}if(p)break;h-=188,d-=188}},d=function(t,e,i){for(var a,n,s,o,h,d,p,u=0,c=188,l=!1,f={data:[],size:0};c<t.byteLength;)if(71!==t[u]||71!==t[c])u++,c++;else{switch(a=t.subarray(u,c),r.ts.parseType(a,e.pid)){case"pes":if(n=r.ts.parsePesType(a,e.table),s=r.ts.parsePayloadUnitStartIndicator(a),"video"===n&&(s&&!l&&(o=r.ts.parsePesTime(a))&&(o.type="video",i.video.push(o),l=!0),!i.firstKeyFrame)){if(s&&0!==f.size){for(h=new Uint8Array(f.size),d=0;f.data.length;)p=f.data.shift(),h.set(p,d),d+=p.byteLength;r.ts.videoPacketContainsKeyFrame(h)&&(i.firstKeyFrame=r.ts.parsePesTime(h),i.firstKeyFrame.type="video"),f.size=0}f.data.push(a),f.size+=a.byteLength}}if(l&&i.firstKeyFrame)break;u+=188,c+=188}for(c=t.byteLength,u=c-188,l=!1;u>=0;)if(71!==t[u]||71!==t[c])u--,c--;else{switch(a=t.subarray(u,c),r.ts.parseType(a,e.pid)){case"pes":n=r.ts.parsePesType(a,e.table),s=r.ts.parsePayloadUnitStartIndicator(a),"video"===n&&s&&(o=r.ts.parsePesTime(a))&&(o.type="video",i.video.push(o),l=!0)}if(l)break;u-=188,c-=188}},p=function(t,e){if(t.audio&&t.audio.length){var i=e;void 0===i&&(i=t.audio[0].dts),t.audio.forEach(function(t){t.dts=n(t.dts,i),t.pts=n(t.pts,i),t.dtsTime=t.dts/9e4,t.ptsTime=t.pts/9e4})}if(t.video&&t.video.length){var a=e;if(void 0===a&&(a=t.video[0].dts),t.video.forEach(function(t){t.dts=n(t.dts,a),t.pts=n(t.pts,a),t.dtsTime=t.dts/9e4,t.ptsTime=t.pts/9e4}),t.firstKeyFrame){var r=t.firstKeyFrame;r.dts=n(r.dts,a),r.pts=n(r.pts,a),r.dtsTime=r.dts/9e4,r.ptsTime=r.dts/9e4}}},u=function(t){for(var e,i=!1,a=0,n=null,s=null,o=0,h=0;t.length-h>=3;){switch(r.aac.parseType(t,h)){case"timed-metadata":if(t.length-h<10){i=!0;break}if((o=r.aac.parseId3TagSize(t,h))>t.length){i=!0;break}null===s&&(e=t.subarray(h,h+o),s=r.aac.parseAacTimestamp(e)),h+=o;break;case"audio":if(t.length-h<7){i=!0;break}if((o=r.aac.parseAdtsSize(t,h))>t.length){i=!0;break}null===n&&(e=t.subarray(h,h+o),n=r.aac.parseSampleRate(e)),a++,h+=o;break;default:h++}if(i)return null}if(null===n||null===s)return null;var d=9e4/n;return{audio:[{type:"audio",dts:s,pts:s},{type:"audio",dts:s+1024*a*d,pts:s+1024*a*d}]}},c=function(t){var e={pid:null,table:null},i={};o(t,e);for(var n in e.table)if(e.table.hasOwnProperty(n)){var r=e.table[n];switch(r){case a.H264_STREAM_TYPE:i.video=[],d(t,e,i),0===i.video.length&&delete i.video;break;case a.ADTS_STREAM_TYPE:i.audio=[],h(t,e,i),0===i.audio.length&&delete i.audio}}return i},l=function(t,e){var i,a=s(t);return(i=a?u(t):c(t))&&(i.audio||i.video)?(p(i,e),i):null};e.exports={inspect:l}},{}],28:[function(t,e,i){var a,n,r,s,o,h;a=function(t){return 9e4*t},n=function(t,e){return t*e},r=function(t){return t/9e4},s=function(t,e){return t/e},o=function(t,e){return a(s(t,e))},h=function(t,e){return n(r(t),e)},e.exports={secondsToVideoTs:a,secondsToAudioTs:n,videoTsToSeconds:r,audioTsToSeconds:s,audioTsToVideoTs:o,videoTsToAudioTs:h}},{}],29:[function(t,e,i){"use strict";var a;a=function(t){var e=t.byteLength,i=0,a=0;this.length=function(){return 8*e},this.bitsAvailable=function(){return 8*e+a},this.loadWord=function(){var n=t.byteLength-e,r=new Uint8Array(4),s=Math.min(4,e);if(0===s)throw new Error("no bytes available");r.set(t.subarray(n,n+s)),i=new DataView(r.buffer).getUint32(0),a=8*s,e-=s},this.skipBits=function(t){var n;a>t?(i<<=t,a-=t):(t-=a,n=Math.floor(t/8),t-=8*n,e-=n,this.loadWord(),i<<=t,a-=t)},this.readBits=function(t){var n=Math.min(a,t),r=i>>>32-n;return a-=n,a>0?i<<=n:e>0&&this.loadWord(),n=t-n,n>0?r<<n|this.readBits(n):r},this.skipLeadingZeros=function(){var t;for(t=0;t<a;++t)if(0!=(i&2147483648>>>t))return i<<=t,a-=t,t;return this.loadWord(),t+this.skipLeadingZeros()},this.skipUnsignedExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())},this.skipExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())},this.readUnsignedExpGolomb=function(){var t=this.skipLeadingZeros();return this.readBits(t+1)-1},this.readExpGolomb=function(){var t=this.readUnsignedExpGolomb();return 1&t?1+t>>>1:-1*(t>>>1)},this.readBoolean=function(){return 1===this.readBits(1)},this.readUnsignedByte=function(){return this.readBits(8)},this.loadWord()},e.exports=a},{}],30:[function(t,e,i){"use strict";var a=function(){this.init=function(){var t={};this.on=function(e,i){t[e]||(t[e]=[]),t[e]=t[e].concat(i)},this.off=function(e,i){var a;return!!t[e]&&(a=t[e].indexOf(i),t[e]=t[e].slice(),t[e].splice(a,1),a>-1)},this.trigger=function(e){var i,a,n,r;if(i=t[e])if(2===arguments.length)for(n=i.length,a=0;a<n;++a)i[a].call(this,arguments[1]);else{for(r=[],a=arguments.length,a=1;a<arguments.length;++a)r.push(arguments[a]);for(n=i.length,a=0;a<n;++a)i[a].apply(this,r)}},this.dispose=function(){t={}}}};a.prototype.pipe=function(t){return this.on("data",function(e){t.push(e)}),this.on("done",function(e){t.flush(e)}),t},a.prototype.push=function(t){this.trigger("data",t)},a.prototype.flush=function(t){this.trigger("done",t)},e.exports=a},{}]},{},[13]);