/*! @name videojs-errors @version 4.5.0 @license Apache-2.0 */
!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?module.exports=r(require("video.js"),require("global/document")):"function"==typeof define&&define.amd?define(["video.js","global/document"],r):(e=e||self).videojsErrors=r(e.videojs,e.document)}(this,(function(e,r){"use strict";e=e&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e,r=r&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r;var o=e.getComponent("Flash"),i=!e.browser.IS_IPHONE,t=e.registerPlugin||e.plugin,n={header:"",code:"",message:"",timeout:45e3,backgroundTimeout:3e5,dismiss:i,errors:{1:{type:"MEDIA_ERR_ABORTED",headline:"The video download was cancelled"},2:{type:"MEDIA_ERR_NETWORK",headline:"The video connection was lost, please confirm you are connected to the internet"},3:{type:"MEDIA_ERR_DECODE",headline:"The video is bad or in a format that cannot be played on your browser"},4:{type:"MEDIA_ERR_SRC_NOT_SUPPORTED",headline:"This video is either unavailable or not supported in this browser"},5:{type:"MEDIA_ERR_ENCRYPTED",headline:"The video you are trying to watch is encrypted and we do not know how to decrypt it"},unknown:{type:"MEDIA_ERR_UNKNOWN",headline:"An unanticipated problem was encountered, check back soon and try again"},"-1":{type:"PLAYER_ERR_NO_SRC",headline:"No video has been loaded"},"-2":{type:"PLAYER_ERR_TIMEOUT",headline:"Could not download the video"},PLAYER_ERR_DOMAIN_RESTRICTED:{headline:"This video is restricted from playing on your current domain"},PLAYER_ERR_IP_RESTRICTED:{headline:"This video is restricted at your current IP address"},PLAYER_ERR_GEO_RESTRICTED:{headline:"This video is restricted from playing in your current geographic region"},FLASHLS_ERR_CROSS_DOMAIN:{headline:"The video could not be loaded: crossdomain access denied."}}},s=function i(t,s){var a,d,l,c=[],u=function(r){s.errors=e.mergeOptions(s.errors,r),Object.keys(s.errors).forEach((function(e){var r=s.errors[e];r.type||(r.type=e)}))};u();var f=function(){t.error()&&-2===t.error().code&&t.error(null),t.clearTimeout(d),t.clearTimeout(a),l&&(l=!1,t.removeClass("vjs-waiting"));var e=[1/0,-1],o=function(e,r){return-1!==e.indexOf(r)};"hidden"===r.visibilityState&&(t.muted()||o(e,s.backgroundTimeout))||"visible"===r.visibilityState&&o(e,s.timeout)||(d=t.setTimeout((function(){t.error()||t.paused()||t.ended()||(l=!0,t.addClass("vjs-waiting"))}),1e3),a=t.setTimeout((function(){t.error()||t.paused()||t.ended()||t.error({code:-2,type:"PLAYER_ERR_TIMEOUT"})}),"hidden"===r.visibilityState?s.backgroundTimeout:s.timeout))},h=function(){for(var e;c.length;)e=c.shift(),t.off(e[0],e[1]);t.clearTimeout(a),t.clearTimeout(d)},p=function e(){var o,i,n,s=0;h(),f(),o=["timeupdate","adtimeupdate"],i=function(){var e=t.currentTime();e!==s&&(s=e,f())},n=function(){if(!t.error()){var e=t.$(".vjs-tech");if(e&&"application/x-shockwave-flash"===e.type&&!e.vjs_getProperty)return void t.error({code:-2,type:"PLAYER_ERR_TIMEOUT"});if(t.paused())return f();if(t.ended())return f()}i.call(this)},t.on(o,n),c.push([o,n]),t.off(r,"visibilitychange",e),t.on(r,"visibilitychange",e)},v=function(){t.currentSrc()||t.error({code:-1,type:"PLAYER_ERR_NO_SRC"})},m=function(){var i="",n=t.error(),a=r.createElement("div"),d="";if(n){if(t.off(r,"visibilitychange",p),(n=e.mergeOptions(n,s.errors[n.code||n.type||0])).message&&(i='<div class="vjs-errors-details">'+t.localize("Technical details")+'\n        : <div class="vjs-errors-message">'+t.localize(n.message)+"</div>\n        </div>"),4===n.code&&o&&!o.isSupported())i+='<span class="vjs-errors-flashmessage">'+t.localize("If you are using an older browser please try upgrading or installing Flash.")+"</span>";var l=t.getChild("errorDisplay");if(a.className="vjs-errors-dialog",a.id="vjs-errors-dialog",d='<div class="vjs-errors-content-container">\n      <h2 class="vjs-errors-headline">'+this.localize(n.headline)+'</h2>\n        <div class="vjs-errors-code"><b>'+this.localize("Error Code")+":</b> "+(n.type||n.code)+"</div>\n        "+i+"\n      </div>",l.closeable(!("dismiss"in n)||n.dismiss)){d+='<div class="vjs-errors-ok-button-container">\n          <button class="vjs-errors-ok-button">'+this.localize("OK")+"</button>\n        </div>",a.innerHTML=d,l.fillWith(a),l.contentEl().firstChild.appendChild(l.getChild("closeButton").el());var c=l.el().querySelector(".vjs-errors-ok-button");t.on(c,"click",(function(){l.close()}))}else a.innerHTML=d,l.fillWith(a);(t.currentWidth()<=600||t.currentHeight()<=250)&&l.addClass("vjs-xs"),l.one("modalclose",(function(){return t.error(null)}))}},E=function e(){h(),t.removeClass("vjs-errors"),t.off("play",p),t.off(r,"visibilitychange",p),t.off("play",v),t.off("dispose",e),t.off(["aderror","error"],m)},y=function(r){E(),i(t,e.mergeOptions(n,r))};y.extend=function(e){return u(e)},y.getAll=function(){return e.mergeOptions(s.errors)},y.timeout=function(e){if(void 0===e)return s.timeout;e!==s.timeout&&(s.timeout=e,t.paused()||p())},y.backgroundTimeout=function(e){if(void 0===e)return s.backgroundTimeout;e!==s.backgroundTimeout&&(s.backgroundTimeout=e,t.paused()||p())},y.disableProgress=function(){},t.on("play",p),t.on("play",v),t.on("dispose",E),t.on(["aderror","contenterror","error"],m),t.ready((function(){t.addClass("vjs-errors")})),t.paused()||p(),y.VERSION="4.5.0",t.errors=y},a=function(r){s(this,e.mergeOptions(n,r))};return["extend","getAll"].forEach((function(r){a[r]=function(){e.log.warn("The errors."+r+"() method is not available until the plugin has been initialized!")}})),a.VERSION="4.5.0",t("errors",a),a}));
