---
layout: post
title: Mono 2.x on CentOS 5
date: 2008-12-17 15:33:00.000000000 +08:00
type: post
published: true
status: publish
categories:
- Tech Note
tags: []
meta:
  blogger_blog: mingster.blogspot.com
  blogger_author: Ming Tsai
  blogger_eb3191f8b77bf2ac10a5fe54aebee9ae_permalink: '2461678172310924803'
author: mingster
---
<p>Mono no longer packages for Red Hat distribution but still provide sources. Here we will grab the source code, and install manually on a Cent OS 5.2 box.</p>
<p>First off, make sure you have all the development tools installed:</p>
<p>Pre-Software requirement<br /><code><br />yum groupinstall "Development Tools"<br />yum install httpd build-essential gcc bzip bison pkgconfig glib-devel \<br />glib2-devel httpd-devel libpng-devel libX11-devel freetype fontconfig \<br />pango-devel ruby ruby-rdoc gtkhtml38-devel wget<br /></code><br />At this time, Mono 2.0.1 is the latest. You can always check for new build at <a href="http://ftp.novell.com/pub/mono/sources-stable/" target="_blank">http://ftp.novell.com/pub/mono/sources-stable/</a></p>
<p>Getting all the needed Mono software<br /><code><br />cd /root<br />wget <a href="http://ftp.novell.com/pub/mono/sources/mono/mono-2.0.1.tar.bz2">http://ftp.novell.com/pub/mono/sources/mono/mono-2.0.1.tar.bz2</a><br />wget <a href="http://ftp.novell.com/pub/mono/sources/xsp/xsp-2.0.tar.bz2">http://ftp.novell.com/pub/mono/sources/xsp/xsp-2.0.tar.bz2</a><br />wget <a href="http://ftp.novell.com/pub/mono/sources/mod_mono/mod_mono-2.0.tar.bz2">http://ftp.novell.com/pub/mono/sources/mod_mono/mod_mono-2.0.tar.bz2</a><br />wget <a href="http://ftp.novell.com/pub/mono/sources/libgdiplus/libgdiplus-2.0.tar.bz2">http://ftp.novell.com/pub/mono/sources/libgdiplus/libgdiplus-2.0.tar.bz2</a><br /></code><br />Unlike many other tutorials, we will install using "Java" style - the version # is included:<br /><code><br />mkdir /opt/mono-2.0.1<br /></code><br />Let's make a desult symlink:,<br /><code><br />ln -s /opt/mono-2.0.1 /opt/mono<br /></code><br />This is needed when building xsp:<br /><code><br />export PKG_CONFIG_PATH=/usr/lib/pkgconfig/:/opt/mono/lib/pkgconfig/:/usr/lib/<br /></code>Set path (even we don't actually have it yet)<br /><code><br />export PATH=/opt/mono/bin:$PATH<br /></code><br />Now we are ready to compile:<br /><code><br />tar jvfx mono-2.0.1.tar.bz2</code><br /><code>cd mono-2.0.1<br />./configure --prefix=/opt/mono-2.0.1<br />make; make install<br /></code><br /><code>tar jvfx xsp-2.0.tar.bz2</code><br /><code>cd ~/xsp-2.0<br />./configure --prefix=/opt/mono<br />make; make install</p>
<p>tar jvfx mod_mono-2.0.tar.bz2</code><br /><code>cd ~/mod_mono-2.0<br />./configure --prefix=/opt/mono --with-mono-prefix=/opt/mono --with-apr-config=/usr/lib/httpd/modules<br />make; make install<br /></code><br /><code>tar jvfx libgdiplus-2.0.tar.bz2<br /></code><code></code><code>cd ~/libgdiplus-2.0<br />./configure<br />make; make install<br /></code><br />You should now have mod_mono.so in /usr/lib/httpd/modules. Also you should have mod_server in /opt/mono/bin.<br />You directories should look like those:</p>
<p>Directory contents are as follows:<br /><code><br />ls /opt/mono/bin/</code>
<pre>al                    mono-api-info<br />al2                   mono-api-info2<br />asp-state             monodis<br />asp-state2            mono-find-provides<br />caspol                mono-find-requires<br />cert2spc              monograph<br />certmgr               monolinker<br />chktrust              monop<br />cilc                  monop2<br />dbsessmgr             mono-service<br />dbsessmgr2            mono-service2<br />disco                 mono-shlib-cop<br />dtd2rng               mono-test-install<br />dtd2xsd               mono-xmltool<br />fastcgi-mono-server   mozroots<br />fastcgi-mono-server2  nunit-console<br />gacutil               nunit-console2<br />genxs                 pedump<br />gmcs                  permview<br />httpcfg               prj2make<br />ilasm                 resgen<br />ilasm2                resgen2<br />installvst            secutil<br />jay                   setreg<br />macpack               sgen<br />makecert              signcode<br />mbas                  smcs<br />mconfig               sn<br />mcs                   soapsuds<br />mjs                   sqlsharp<br />mkbundle              wsdl<br />mkbundle2             wsdl2<br />mod-mono-server       xbuild<br />mod-mono-server2      xsd<br />mono                  xsp<br />mono-api-diff         xsp2<br /></pre>
<p>ls /opt/mono/lib/
<pre>libgdiplus.a             libmono-profiler-aot.so.0<br />libgdiplus.la            libmono-profiler-aot.so.0.0.0<br />libgdiplus.so            libmono-profiler-cov.a<br />libgdiplus.so.0          libmono-profiler-cov.la<br />libgdiplus.so.0.0.0      libmono-profiler-cov.so<br />libikvm-native.a         libmono-profiler-cov.so.0<br />libikvm-native.la        libmono-profiler-cov.so.0.0.0<br />libikvm-native.so        libmono.so<br />libmono.a                libmono.so.0<br />libmono.la               libmono.so.0.0.0<br />libMonoPosixHelper.a     libMonoSupportW.a<br />libMonoPosixHelper.la    libMonoSupportW.la<br />libMonoPosixHelper.so    libMonoSupportW.so<br />libmono-profiler-aot.a   mono<br />libmono-profiler-aot.la  pkgconfig<br />libmono-profiler-aot.so  xsp<br /></pre>
<p>ls /usr/lib/httpd/modules/
<pre>libphp5.so              mod_file_cache.so<br />mod_actions.so          mod_filter.so<br />mod_alias.so            mod_headers.so<br />mod_asis.so             mod_ident.so<br />mod_auth_basic.so       mod_imagemap.so<br />mod_auth_digest.so      mod_include.so<br />mod_authn_alias.so      mod_info.so<br />mod_authn_anon.so       mod_ldap.so<br />mod_authn_dbd.so        mod_log_config.so<br />mod_authn_dbm.so        mod_log_forensic.so<br />mod_authn_default.so    mod_logio.so<br />mod_authn_file.so       mod_mem_cache.so<br />mod_authnz_ldap.so      mod_mime_magic.so<br />mod_authz_dbm.so        mod_mime.so<br />mod_authz_default.so    mod_mono.so<br />mod_authz_groupfile.so  mod_mono.so.0.0.0<br />mod_authz_host.so       mod_negotiation.so<br />mod_authz_owner.so      mod_proxy_ajp.so<br />mod_authz_user.so       mod_proxy_balancer.so<br />mod_autoindex.so        mod_proxy_connect.so<br />mod_cache.so            mod_proxy_ftp.so<br />mod_cern_meta.so        mod_proxy_http.so<br />mod_cgid.so             mod_proxy.so<br />mod_cgi.so              mod_rewrite.so<br />mod_dav_fs.so           mod_setenvif.so<br />mod_dav.so              mod_speling.so<br />mod_dbd.so              mod_status.so<br />mod_deflate.so          mod_suexec.so<br />mod_dir.so              mod_unique_id.so<br />mod_disk_cache.so       mod_userdir.so<br />mod_dumpio.so           mod_usertrack.so<br />mod_env.so              mod_version.so<br />mod_expires.so          mod_vhost_alias.so<br />mod_ext_filter.so<br /></pre>
<p>And the mod_mono config file should be like this:<br /><code><br />ls /etc/httpd/conf/mod_mono.conf<br />vi </code><code>/etc/httpd/conf/mod_mono.conf</code>
<pre><br />LoadModule mono_module /usr/lib/httpd/modules/mod_mono.so<br />AddType application/x-asp-net .aspx<br />AddType application/x-asp-net .asmx<br />AddType application/x-asp-net .ashx<br />AddType application/x-asp-net .asax<br />AddType application/x-asp-net .ascx<br />AddType application/x-asp-net .soap<br />AddType application/x-asp-net .rem<br />AddType application/x-asp-net .axd<br />AddType application/x-asp-net .cs<br />AddType application/x-asp-net .config<br />AddType application/x-asp-net .Config<br />AddType application/x-asp-net .dll<br />DirectoryIndex index.aspx<br />DirectoryIndex Default.aspx<br />DirectoryIndex default.aspx<br /><br /></pre>
<p>Let's move it to CentOS style:<br /><code><br />mv /etc/httpd/conf/mod_mono.conf /etc/httpd/conf.d/mod_mono.conf<br /></code><br />Restart web server<br /><code><br />service httpd restart<br /></code><br />Make a simple test file named default.aspx:<code><br /></code><br />If you see that message at http://localhost/default.aspx, congrad, there you have it!</p>
